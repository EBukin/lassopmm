<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R versus STATA ‘lassopmm’ • lassopmm</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="R versus STATA ‘lassopmm’">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lassopmm</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/how_it_works.html">How it works in steps</a>
    </li>
    <li>
      <a href="../articles/mice_vs_mi.html">Multiple imputation statistics in STATA and R</a>
    </li>
    <li>
      <a href="../articles/r_vs_stata_lassopmm.html">R versus STATA 'lassopmm'</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="r_vs_stata_lassopmm_files/kePrint-0.0.1/kePrint.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>R versus STATA ‘lassopmm’</h1>
            
      
      
      <div class="hidden name"><code>r_vs_stata_lassopmm.Rmd</code></div>

    </div>

    
    
<div id="argentina-example" class="section level2">
<h2 class="hasAnchor">
<a href="#argentina-example" class="anchor"></a>Argentina example</h2>
<div id="running-lassopmm-in-r" class="section level3">
<h3 class="hasAnchor">
<a href="#running-lassopmm-in-r" class="anchor"></a>Running <code><a href="../reference/lassopmm.html">lassopmm()</a></code> in R</h3>
<p>Let us follow the example of Argentina. We start with initializing all necessary libraries and loading data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(kableExtra)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(lassopmm)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(mice)</a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(statar)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(tidyr)</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(purrr)</a>
<a class="sourceLine" id="cb1-8" title="8">period0 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span>(<span class="st">"DATA LOCATION 0.dta"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/zap_labels.html">zap_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pondera =</span> pondera <span class="op">*</span><span class="st"> </span>miembros)</a>
<a class="sourceLine" id="cb1-12" title="12">period1 &lt;-</a>
<a class="sourceLine" id="cb1-13" title="13"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span>(<span class="st">"DATA LOCATION 1.dta"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/zap_labels.html">zap_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pondera =</span> pondera <span class="op">*</span><span class="st"> </span>miembros)</a></code></pre></div>
<p>We have the following set of the parameters used in Stata code for the analysis:</p>
<ul>
<li>Actual data for period 1 is used for predicting income in period 0 and not other way around.</li>
<li>Dependent variable: <code>lipcf</code>
</li>
<li>Independent variables: …</li>
<li>Weight variable: …</li>
<li>Number of bootstrap operations: 50</li>
<li>Number of the nearest matches: 10</li>
</ul>
<p>We run analysis with the same inputs in R:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">dependent_var &lt;-<span class="st"> "lipcf"</span></a>
<a class="sourceLine" id="cb2-2" title="2">independent_vars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"hombre"</span>, <span class="st">"aedu"</span>, <span class="st">"miembros"</span>, <span class="st">"miembros2"</span>, </a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="st">"region1"</span>, <span class="st">"region2"</span>, <span class="st">"region3"</span>, <span class="st">"region4"</span>, <span class="st">"region5"</span>, <span class="st">"region6"</span>, </a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="st">"hombre_region1"</span>, <span class="st">"hombre_region2"</span>, <span class="st">"hombre_region3"</span>, </a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="st">"hombre_region4"</span>, <span class="st">"hombre_region5"</span>, <span class="st">"hombre_region6"</span>, </a>
<a class="sourceLine" id="cb2-7" title="7">    <span class="st">"aedu_region1"</span>, <span class="st">"aedu_region2"</span>, <span class="st">"aedu_region3"</span>, </a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="st">"aedu_region4"</span>, <span class="st">"aedu_region5"</span>, <span class="st">"aedu_region6"</span>, </a>
<a class="sourceLine" id="cb2-9" title="9">    <span class="st">"miembros_region1"</span>, <span class="st">"miembros_region2"</span>, <span class="st">"miembros_region3"</span>, </a>
<a class="sourceLine" id="cb2-10" title="10">    <span class="st">"miembros_region4"</span>, <span class="st">"miembros_region5"</span>, <span class="st">"miembros_region6"</span>, </a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="st">"miembros2_region1"</span>, <span class="st">"miembros2_region2"</span>, <span class="st">"miembros2_region3"</span>, </a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="st">"miembros2_region4"</span>, <span class="st">"miembros2_region5"</span>, <span class="st">"miembros2_region6"</span>, </a>
<a class="sourceLine" id="cb2-13" title="13">    <span class="st">"edad"</span>, <span class="st">"edad2"</span>, </a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="st">"edad_region1"</span>, <span class="st">"edad_region2"</span>, <span class="st">"edad_region3"</span>, </a>
<a class="sourceLine" id="cb2-15" title="15">    <span class="st">"edad_region4"</span>, <span class="st">"edad_region5"</span>, <span class="st">"edad_region6"</span>, </a>
<a class="sourceLine" id="cb2-16" title="16">    <span class="st">"edad2_region1"</span>, <span class="st">"edad2_region2"</span>, <span class="st">"edad2_region3"</span>, </a>
<a class="sourceLine" id="cb2-17" title="17">    <span class="st">"edad2_region4"</span>, <span class="st">"edad2_region5"</span>, <span class="st">"edad2_region6"</span></a>
<a class="sourceLine" id="cb2-18" title="18">  )</a>
<a class="sourceLine" id="cb2-19" title="19">weight_var &lt;-<span class="st"> "pondera"</span></a>
<a class="sourceLine" id="cb2-20" title="20">n_iterations &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb2-21" title="21">n_nearest &lt;-<span class="st"> </span><span class="dv">10</span></a></code></pre></div>
<p>Running the analysis is made in one command:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">11738</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">r_mi_data_raw &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/lassopmm.html">lassopmm</a></span>(period1, </a>
<a class="sourceLine" id="cb3-4" title="4">           period0, </a>
<a class="sourceLine" id="cb3-5" title="5">           <span class="dt">dep_var =</span> dependent_var, </a>
<a class="sourceLine" id="cb3-6" title="6">           <span class="dt">indep_var =</span> independent_vars, </a>
<a class="sourceLine" id="cb3-7" title="7">           <span class="dt">weight_var =</span> weight_var, </a>
<a class="sourceLine" id="cb3-8" title="8">           <span class="dt">n_near =</span> n_nearest, </a>
<a class="sourceLine" id="cb3-9" title="9">           <span class="dt">n_boot =</span> n_iterations)</a></code></pre></div>
</div>
<div id="getting-multiple-imputations-means-and-mean-overx" class="section level3">
<h3 class="hasAnchor">
<a href="#getting-multiple-imputations-means-and-mean-overx" class="anchor"></a>Getting multiple imputations means and mean “, over(x)”</h3>
<p>For this comparison, we use variables <code>g_a</code> and <code>g_p</code> with grouping by <code>perc</code> and mobility. Following Stata code, we implement same calculations of <code>perc</code>, <code>g_a</code> and <code>g_p</code> on the <code>r_mi_data</code> in R. Following Stata code, we also create variables <code>mobility_actual</code> and <code>mobility_pred</code>.</p>
<p>Note that running <code><a href="../reference/lassopmm.html">lassopmm()</a></code> has created one new variable <code>lipcf_source</code> for all imputations. In general, the name of the new variable originates from our dependent variable adding to in in the end ’_source’.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">r_mi_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="st">  </span>r_mi_data_raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="dt">ipcf_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(lipcf_source),</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="dt">perc =</span> statar<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/statar/topics/xtile">xtile</a></span>(ipcf, <span class="dt">wt =</span> pondera, <span class="dt">n =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="dt">g_a =</span> (ipcf_<span class="dv">2014</span><span class="op">/</span>ipcf) <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="dv">2013</span> <span class="op">-</span><span class="st"> </span><span class="dv">2014</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="dt">g_p =</span> (ipcf_pred<span class="op">/</span>ipcf) <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="dv">2013</span> <span class="op">-</span><span class="st"> </span><span class="dv">2014</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb4-8" title="8">    <span class="dt">poor_pred =</span> <span class="kw">if_else</span>(lipcf_source <span class="op">&lt;</span><span class="st"> </span>lpl, <span class="dv">1</span>, <span class="dv">0</span>, <span class="ot">NA_real_</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb4-11" title="11">      <span class="dt">poor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb4-12" title="12">      <span class="dt">poor_2014 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb4-13" title="13">      <span class="dt">mobility_actual =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb4-14" title="14">    ), </a>
<a class="sourceLine" id="cb4-15" title="15">    <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"poor"</span>, <span class="st">"poor_2014"</span>)</a>
<a class="sourceLine" id="cb4-16" title="16">  )<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb4-17" title="17"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb4-18" title="18">    <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb4-19" title="19">      <span class="dt">poor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb4-20" title="20">      <span class="dt">poor_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb4-21" title="21">      <span class="dt">mobility_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb4-22" title="22">    ), </a>
<a class="sourceLine" id="cb4-23" title="23">    <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"poor"</span>, <span class="st">"poor_pred"</span>)</a>
<a class="sourceLine" id="cb4-24" title="24">  )</a></code></pre></div>
<div id="simple-weighted-mean" class="section level4">
<h4 class="hasAnchor">
<a href="#simple-weighted-mean" class="anchor"></a>Simple weighted mean</h4>
<p>Let us first find simple weighted means of <code>g_a</code> and <code>g_p</code> on the multiple imputation data and compare it with the same in Stata.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb5-2" title="2">  r_mi_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/get_mi_mean.html">get_mi_mean</a></span>(<span class="st">"g_a"</span>, <span class="st">"pondera"</span>),</a>
<a class="sourceLine" id="cb5-3" title="3">  r_mi_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/get_mi_mean.html">get_mi_mean</a></span>(<span class="st">"g_p"</span>, <span class="st">"pondera"</span>) </a>
<a class="sourceLine" id="cb5-4" title="4">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.07009553
</td>
<td style="text-align:right;">
0.01145724
</td>
<td style="text-align:right;">
6.118012
</td>
<td style="text-align:right;">
3322.66725
</td>
<td style="text-align:right;">
1.10e-09
</td>
<td style="text-align:right;">
0.04763157
</td>
<td style="text-align:right;">
0.09255948
</td>
<td style="text-align:right;">
0.00000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0.0001312683
</td>
<td style="text-align:right;">
0.00000000
</td>
<td style="text-align:right;">
0.0001312683
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.22784337
</td>
<td style="text-align:right;">
0.03823460
</td>
<td style="text-align:right;">
5.959089
</td>
<td style="text-align:right;">
75.46904
</td>
<td style="text-align:right;">
7.56e-08
</td>
<td style="text-align:right;">
0.15168390
</td>
<td style="text-align:right;">
0.30400284
</td>
<td style="text-align:right;">
3.26845
</td>
<td style="text-align:right;">
0.7657229
</td>
<td style="text-align:right;">
0.7716941208
</td>
<td style="text-align:right;">
0.0003424861
</td>
<td style="text-align:right;">
0.00109745
</td>
<td style="text-align:right;">
0.0014618846
</td>
<td style="text-align:right;">
3325
</td>
</tr>
</tbody>
</table>
</div>
<p>Same as Stata below:</p>
<pre><code>mi estimate: mean g_a g_p [aw = pondera]
Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      3,326
                                  Average RVI     =     1.4442
                                  Largest FMI     =     0.7227
                                  Complete DF     =       3325
DF adjustment:   Small sample     DF:     min     =      86.65
                                          avg     =   1,704.83
Within VCE type:     Analytic             max     =   3,323.00

--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
         g_a |   .0700955   .0114572      .0476316    .0925595
         g_p |   .2378207   .0353957       .167464    .3081775
--------------------------------------------------------------</code></pre>
</div>
<div id="weighted-mean-by-groups-of-equall-size-in-all-imputation" class="section level4">
<h4 class="hasAnchor">
<a href="#weighted-mean-by-groups-of-equall-size-in-all-imputation" class="anchor"></a>Weighted mean by groups of equall size in all imputation</h4>
<p>Lets do the same as in the previous section but this time using the group-wise weighted means. We do grouping by <code>perc</code> variable, which is derived from the actual values of <code>ipcf</code>. Therefore, each imputation has the same values of the <code>perc</code> variable and every group created based on the <code>perc</code> variable is the same across all imputations.</p>
<p>To demonstrate it, we do the following:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">r_mi_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(.imp, perc) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">  </span><span class="kw">spread</span>(.imp, n) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
perc
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
7
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
9
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
11
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
12
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
13
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
14
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
15
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
16
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
17
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
18
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
19
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
20
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
21
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
22
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
23
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
24
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
25
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
26
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
27
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
28
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
29
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
30
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
31
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
32
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
33
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
34
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
35
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
36
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
37
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
38
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
39
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
40
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
41
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
42
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
43
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
44
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
45
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
46
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
47
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
48
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
49
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
50
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
<td style="text-align:right;">
521
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
<td style="text-align:right;">
530
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
<td style="text-align:right;">
657
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
<td style="text-align:right;">
688
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
<td style="text-align:right;">
930
</td>
</tr>
</tbody>
</table>
</div>
<p>The group by means are calculated in the following way:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(r_mi_data, <span class="st">"g_a"</span>, <span class="st">"perc"</span>, <span class="st">"pondera"</span>),</a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(r_mi_data, <span class="st">"g_p"</span>, <span class="st">"perc"</span>, <span class="st">"pondera"</span>)</a>
<a class="sourceLine" id="cb8-4" title="4">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
perc
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.43150414
</td>
<td style="text-align:right;">
0.04475951
</td>
<td style="text-align:right;">
9.640502
</td>
<td style="text-align:right;">
517.95962
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.343571635
</td>
<td style="text-align:right;">
0.5194366384
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.003839069
</td>
<td style="text-align:right;">
0.0020034139
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0020034139
</td>
<td style="text-align:right;">
520
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.04467507
</td>
<td style="text-align:right;">
0.02541860
</td>
<td style="text-align:right;">
1.757574
</td>
<td style="text-align:right;">
526.95852
</td>
<td style="text-align:right;">
0.0794006519
</td>
<td style="text-align:right;">
-0.005259163
</td>
<td style="text-align:right;">
0.0946093095
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.003773880
</td>
<td style="text-align:right;">
0.0006461054
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0006461054
</td>
<td style="text-align:right;">
529
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.04749590
</td>
<td style="text-align:right;">
0.02155452
</td>
<td style="text-align:right;">
2.203524
</td>
<td style="text-align:right;">
653.94362
</td>
<td style="text-align:right;">
0.0279056846
</td>
<td style="text-align:right;">
0.005171481
</td>
<td style="text-align:right;">
0.0898203191
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.003044401
</td>
<td style="text-align:right;">
0.0004645974
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0004645974
</td>
<td style="text-align:right;">
656
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.03027516
</td>
<td style="text-align:right;">
0.01584276
</td>
<td style="text-align:right;">
-1.910977
</td>
<td style="text-align:right;">
684.94010
</td>
<td style="text-align:right;">
0.0564246889
</td>
<td style="text-align:right;">
-0.061381368
</td>
<td style="text-align:right;">
0.0008310551
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.002907230
</td>
<td style="text-align:right;">
0.0002509931
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0002509931
</td>
<td style="text-align:right;">
687
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.14337471
</td>
<td style="text-align:right;">
0.01198281
</td>
<td style="text-align:right;">
-11.965028
</td>
<td style="text-align:right;">
926.91356
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
-0.166891298
</td>
<td style="text-align:right;">
-0.1198581153
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.002150737
</td>
<td style="text-align:right;">
0.0001435878
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0001435878
</td>
<td style="text-align:right;">
929
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
1.08993240
</td>
<td style="text-align:right;">
0.13097477
</td>
<td style="text-align:right;">
8.321698
</td>
<td style="text-align:right;">
58.04412
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.827762163
</td>
<td style="text-align:right;">
1.3521026384
</td>
<td style="text-align:right;">
2.513790
</td>
<td style="text-align:right;">
0.7154070
</td>
<td style="text-align:right;">
0.724731204
</td>
<td style="text-align:right;">
0.0048820186
</td>
<td style="text-align:right;">
0.0120317362
</td>
<td style="text-align:right;">
0.0171543895
</td>
<td style="text-align:right;">
520
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.32450374
</td>
<td style="text-align:right;">
0.07012784
</td>
<td style="text-align:right;">
4.627317
</td>
<td style="text-align:right;">
69.09228
</td>
<td style="text-align:right;">
0.0000168101
</td>
<td style="text-align:right;">
0.184605858
</td>
<td style="text-align:right;">
0.4644016213
</td>
<td style="text-align:right;">
1.941723
</td>
<td style="text-align:right;">
0.6600632
</td>
<td style="text-align:right;">
0.669493793
</td>
<td style="text-align:right;">
0.0016717800
</td>
<td style="text-align:right;">
0.0031824844
</td>
<td style="text-align:right;">
0.0049179141
</td>
<td style="text-align:right;">
529
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.11590528
</td>
<td style="text-align:right;">
0.04806682
</td>
<td style="text-align:right;">
2.411337
</td>
<td style="text-align:right;">
83.90507
</td>
<td style="text-align:right;">
0.0180766257
</td>
<td style="text-align:right;">
0.020317557
</td>
<td style="text-align:right;">
0.2114929988
</td>
<td style="text-align:right;">
1.641159
</td>
<td style="text-align:right;">
0.6213783
</td>
<td style="text-align:right;">
0.630091796
</td>
<td style="text-align:right;">
0.0008747747
</td>
<td style="text-align:right;">
0.0014074945
</td>
<td style="text-align:right;">
0.0023104191
</td>
<td style="text-align:right;">
656
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.09538229
</td>
<td style="text-align:right;">
0.04200413
</td>
<td style="text-align:right;">
-2.270784
</td>
<td style="text-align:right;">
66.56167
</td>
<td style="text-align:right;">
0.0264012961
</td>
<td style="text-align:right;">
-0.179233023
</td>
<td style="text-align:right;">
-0.0115315524
</td>
<td style="text-align:right;">
2.372644
</td>
<td style="text-align:right;">
0.7034967
</td>
<td style="text-align:right;">
0.712021616
</td>
<td style="text-align:right;">
0.0005231346
</td>
<td style="text-align:right;">
0.0012168745
</td>
<td style="text-align:right;">
0.0017643466
</td>
<td style="text-align:right;">
687
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.29709839
</td>
<td style="text-align:right;">
0.02695177
</td>
<td style="text-align:right;">
-11.023335
</td>
<td style="text-align:right;">
65.82451
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
-0.350912012
</td>
<td style="text-align:right;">
-0.2432847692
</td>
<td style="text-align:right;">
2.803912
</td>
<td style="text-align:right;">
0.7371127
</td>
<td style="text-align:right;">
0.744752062
</td>
<td style="text-align:right;">
0.0001909608
</td>
<td style="text-align:right;">
0.0005249383
</td>
<td style="text-align:right;">
0.0007263979
</td>
<td style="text-align:right;">
929
</td>
</tr>
</tbody>
</table>
</div>
<p>R produces very close results to Stata.</p>
<pre><code>. mi estimate: mean g_a g_p [aw = pondera],over(perc)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      3,326
                                  Average RVI     =     1.2358
                                  Largest FMI     =     0.7367
                                  Complete DF     =       3325
DF adjustment:   Small sample     DF:     min     =      83.27
                                          avg     =   1,707.62
Within VCE type:     Analytic             max     =   3,323.00
--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
g_a          |
           1 |   .4315041   .0447595      .3437451    .5192631
           2 |   .0446751   .0254186     -.0051626    .0945128
           3 |   .0474959   .0215545      .0052344    .0897574
           4 |  -.0302752   .0158428     -.0613377    .0007874
           5 |  -.1433747   .0119828     -.1668691   -.1198803
-------------+------------------------------------------------
g_p          |
           1 |   1.123281   .1322436      .8605087    1.386054
           2 |   .3228994   .0677601      .1886621    .4571366
           3 |   .1243648   .0557208      .0136161    .2351135
           4 |  -.0863139   .0429758     -.1717136   -.0009142
           5 |  -.2964972   .0267038     -.3496075    -.243387
--------------------------------------------------------------</code></pre>
<p>Another example of weighted means by groups equal for many imputations is the following:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(r_mi_data, <span class="st">"g_a"</span>, <span class="st">"mobility_actual"</span>, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_actual
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.06833180
</td>
<td style="text-align:right;">
0.03836201
</td>
<td style="text-align:right;">
-1.781236
</td>
<td style="text-align:right;">
48.10840
</td>
<td style="text-align:right;">
0.08118767
</td>
<td style="text-align:right;">
-0.14545930
</td>
<td style="text-align:right;">
0.008795709
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0391325138
</td>
<td style="text-align:right;">
0.0014716440
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0014716440
</td>
<td style="text-align:right;">
50
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.54777782
</td>
<td style="text-align:right;">
0.01758967
</td>
<td style="text-align:right;">
-31.142012
</td>
<td style="text-align:right;">
121.03551
</td>
<td style="text-align:right;">
0.00000000
</td>
<td style="text-align:right;">
-0.58260112
</td>
<td style="text-align:right;">
-0.512954527
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0161244145
</td>
<td style="text-align:right;">
0.0003093966
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0003093966
</td>
<td style="text-align:right;">
123
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
1.16372140
</td>
<td style="text-align:right;">
0.12839738
</td>
<td style="text-align:right;">
9.063436
</td>
<td style="text-align:right;">
84.05901
</td>
<td style="text-align:right;">
0.00000000
</td>
<td style="text-align:right;">
0.90839176
</td>
<td style="text-align:right;">
1.419051042
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0229729244
</td>
<td style="text-align:right;">
0.0164858860
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0164858860
</td>
<td style="text-align:right;">
86
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.07766824
</td>
<td style="text-align:right;">
0.01115662
</td>
<td style="text-align:right;">
6.961626
</td>
<td style="text-align:right;">
3060.69394
</td>
<td style="text-align:right;">
0.00000000
</td>
<td style="text-align:right;">
0.05579301
</td>
<td style="text-align:right;">
0.099543471
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006528067
</td>
<td style="text-align:right;">
0.0001244702
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0001244702
</td>
<td style="text-align:right;">
3063
</td>
</tr>
</tbody>
</table>
</div>
<p>Same analysis in Stata is similar to R.</p>
<pre><code>. mi estimate: mean g_a [aw = pondera],over(mobility_actual)
Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      3,326
                                  Average RVI     =     0.0000
                                  Largest FMI     =     0.0000
                                  Complete DF     =       3325
DF adjustment:   Small sample     DF:     min     =   3,323.00
                                          avg     =   3,323.00
Within VCE type:     Analytic             max     =   3,323.00
--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
           1 |  -.0683318    .038362     -.1435474    .0068838
           2 |  -.5477778   .0175897     -.5822655   -.5132901
           3 |   1.163721   .1283974      .9119755    1.415467
           4 |   .0776682   .0111566      .0557937    .0995428
--------------------------------------------------------------</code></pre>
</div>
<div id="weighted-mean-by-unequal-groups" class="section level4">
<h4 class="hasAnchor">
<a href="#weighted-mean-by-unequal-groups" class="anchor"></a>Weighted mean by unequal groups</h4>
<p>In this example, we create groups based on the predicted data. Predicted data vary from one imputation to another, therefore, groups created based on this data also have unequal size. This complicates analysis of variance because for calculating within and between variance on the multiple imputation data, all groups have to be of equal size.</p>
<p>In our analysis, when we create groups based on the <code>mobility_pred</code> variable, for every single imputation, each group has different number of observation. In addition, data for imputation 0 (data without imputations) is not available for each group of <code>mobility_pred</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">r_mi_data <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(.imp, mobility_pred) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="st">  </span><span class="kw">count</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="st">  </span><span class="kw">spread</span>(.imp, n)<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
0
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
3
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
4
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
5
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
6
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
7
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
8
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
9
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
10
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
11
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
12
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
13
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
14
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
15
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
16
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
17
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
18
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
19
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
20
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
21
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
22
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
23
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
24
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
25
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
26
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
27
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
28
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
29
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
30
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
31
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
32
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
33
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
34
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
35
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
36
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
37
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
38
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
39
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
40
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
41
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
42
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
43
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
44
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
45
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
46
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
47
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
48
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
49
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
50
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
27
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
144
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
155
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
131
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
133
</td>
<td style="text-align:right;">
158
</td>
<td style="text-align:right;">
153
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
149
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
155
</td>
<td style="text-align:right;">
141
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
156
</td>
<td style="text-align:right;">
163
</td>
<td style="text-align:right;">
128
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
139
</td>
<td style="text-align:right;">
129
</td>
<td style="text-align:right;">
159
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
145
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
167
</td>
<td style="text-align:right;">
130
</td>
<td style="text-align:right;">
150
</td>
<td style="text-align:right;">
138
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
154
</td>
<td style="text-align:right;">
143
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
146
</td>
<td style="text-align:right;">
132
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
152
</td>
<td style="text-align:right;">
135
</td>
<td style="text-align:right;">
176
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
110
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
114
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
105
</td>
<td style="text-align:right;">
108
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
114
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
111
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
120
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
107
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
122
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
119
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
121
</td>
<td style="text-align:right;">
118
</td>
<td style="text-align:right;">
114
</td>
<td style="text-align:right;">
114
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
113
</td>
<td style="text-align:right;">
112
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
111
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3044
</td>
<td style="text-align:right;">
3080
</td>
<td style="text-align:right;">
3053
</td>
<td style="text-align:right;">
3060
</td>
<td style="text-align:right;">
3033
</td>
<td style="text-align:right;">
3059
</td>
<td style="text-align:right;">
3071
</td>
<td style="text-align:right;">
3040
</td>
<td style="text-align:right;">
3057
</td>
<td style="text-align:right;">
3034
</td>
<td style="text-align:right;">
3055
</td>
<td style="text-align:right;">
3030
</td>
<td style="text-align:right;">
3035
</td>
<td style="text-align:right;">
3049
</td>
<td style="text-align:right;">
3059
</td>
<td style="text-align:right;">
3040
</td>
<td style="text-align:right;">
3039
</td>
<td style="text-align:right;">
3042
</td>
<td style="text-align:right;">
3038
</td>
<td style="text-align:right;">
3050
</td>
<td style="text-align:right;">
3033
</td>
<td style="text-align:right;">
3047
</td>
<td style="text-align:right;">
3056
</td>
<td style="text-align:right;">
3032
</td>
<td style="text-align:right;">
3025
</td>
<td style="text-align:right;">
3060
</td>
<td style="text-align:right;">
3049
</td>
<td style="text-align:right;">
3042
</td>
<td style="text-align:right;">
3049
</td>
<td style="text-align:right;">
3059
</td>
<td style="text-align:right;">
3029
</td>
<td style="text-align:right;">
3038
</td>
<td style="text-align:right;">
3043
</td>
<td style="text-align:right;">
3073
</td>
<td style="text-align:right;">
3021
</td>
<td style="text-align:right;">
3058
</td>
<td style="text-align:right;">
3038
</td>
<td style="text-align:right;">
3050
</td>
<td style="text-align:right;">
3054
</td>
<td style="text-align:right;">
3054
</td>
<td style="text-align:right;">
3066
</td>
<td style="text-align:right;">
3034
</td>
<td style="text-align:right;">
3045
</td>
<td style="text-align:right;">
3028
</td>
<td style="text-align:right;">
3042
</td>
<td style="text-align:right;">
3056
</td>
<td style="text-align:right;">
3040
</td>
<td style="text-align:right;">
3036
</td>
<td style="text-align:right;">
3053
</td>
<td style="text-align:right;">
3012
</td>
</tr>
<tr>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
3326
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
<td style="text-align:right;">
NA
</td>
</tr>
</tbody>
</table>
</div>
<p>This is, unfortunately, a limitation of the R <code>mice</code> package as well as several other R packages for multiple imputations analysis.</p>
<p>Stata by default resolves this problem adding a note in the end of statistics "Note: Numbers of observations in e(_N) vary among imputations.". However, there is no documentation about this note and problem and the source code is not available. So the way how Stata resolves this problem remains a black box to me at the moment of writing.</p>
<p>To resolve this problem in R, I do some data shuffling. This shuffling only comes to an action with the respective warning messages when we do group-wise calculations, where data is split into groups and calculations are preformed on each group separately.</p>
<p>Problem 1. Absence of the non-imputed data (data for <code>imputation == 0</code>) in each group. it is clear that because we use predicted variables for creating groups, we are missing <code>imputation = 0</code> data in each group. This is a problem for calculating statistics and in order for it to work, we need to bring the non imputed values back into each group. We do this by simply finding all unique ID for which values were imputed in the groups and add <code>imputation=0</code> observations with this IDs to each specific group.</p>
<p>Problem 2. Unequal groups size. When we have for all iteration in each group necessary for calculating means, we still have unequal group size across iterations. To resolve this problem we randomly sub sample (without repetitions) data for same groups in all imputations to the size of the smallest group. For example, we have 50 imputations for a group with predicted mobility equal to 1. Size of this group 1 in each imputation vary from 18 to 25 observations. In order to make this group of equal size for all imputations, we sub sample each group to the size of 18 observations and run statistics. This is done with the argument <code>use_random = TRUE</code> in the function <code><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group()</a></code>. Specifying the same argument as <code>FALSE</code> implement slightly different methodology, where instead of random sampling simply first <code>n</code> observations in each group are selected, where <code>n</code> equal to the size of the smallest group across imputations.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(r_mi_data, <span class="st">"g_p"</span>, <span class="st">"mobility_pred"</span>, <span class="st">"pondera"</span>, <span class="dt">use_random =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(r_mi_data, <span class="st">"g_p"</span>, <span class="st">"mobility_pred"</span>, <span class="st">"pondera"</span>, <span class="dt">use_random =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-4" title="4">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.004778750
</td>
<td style="text-align:right;">
0.08896171
</td>
<td style="text-align:right;">
-0.05371693
</td>
<td style="text-align:right;">
3.504265
</td>
<td style="text-align:right;">
0.9600803829
</td>
<td style="text-align:right;">
-0.2661859
</td>
<td style="text-align:right;">
0.2566284
</td>
<td style="text-align:right;">
2.3995168
</td>
<td style="text-align:right;">
0.7058406
</td>
<td style="text-align:right;">
0.7962918
</td>
<td style="text-align:right;">
0.0023280324
</td>
<td style="text-align:right;">
0.0054766206
</td>
<td style="text-align:right;">
0.007914185
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.602396889
</td>
<td style="text-align:right;">
0.04201524
</td>
<td style="text-align:right;">
-14.33758073
</td>
<td style="text-align:right;">
15.526344
</td>
<td style="text-align:right;">
0.0000000002
</td>
<td style="text-align:right;">
-0.6916866
</td>
<td style="text-align:right;">
-0.5131072
</td>
<td style="text-align:right;">
4.3489496
</td>
<td style="text-align:right;">
0.8130474
</td>
<td style="text-align:right;">
0.8332298
</td>
<td style="text-align:right;">
0.0003300237
</td>
<td style="text-align:right;">
0.0014071143
</td>
<td style="text-align:right;">
0.001765280
</td>
<td style="text-align:right;">
107
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.195250739
</td>
<td style="text-align:right;">
0.31463353
</td>
<td style="text-align:right;">
6.97716721
</td>
<td style="text-align:right;">
35.078528
</td>
<td style="text-align:right;">
0.0000000404
</td>
<td style="text-align:right;">
1.5565618
</td>
<td style="text-align:right;">
2.8339396
</td>
<td style="text-align:right;">
1.2613535
</td>
<td style="text-align:right;">
0.5577870
</td>
<td style="text-align:right;">
0.5810133
</td>
<td style="text-align:right;">
0.0437765503
</td>
<td style="text-align:right;">
0.0541350068
</td>
<td style="text-align:right;">
0.098994257
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.217705076
</td>
<td style="text-align:right;">
0.03173823
</td>
<td style="text-align:right;">
6.85939658
</td>
<td style="text-align:right;">
96.217375
</td>
<td style="text-align:right;">
0.0000000007
</td>
<td style="text-align:right;">
0.1547070
</td>
<td style="text-align:right;">
0.2807031
</td>
<td style="text-align:right;">
2.0992669
</td>
<td style="text-align:right;">
0.6773431
</td>
<td style="text-align:right;">
0.6838471
</td>
<td style="text-align:right;">
0.0003250172
</td>
<td style="text-align:right;">
0.0006689194
</td>
<td style="text-align:right;">
0.001007315
</td>
<td style="text-align:right;">
3011
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.11871728
</td>
<td style="text-align:right;">
5.431645
</td>
<td style="text-align:right;">
0.9097664696
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
1.1992894
</td>
<td style="text-align:right;">
0.5453077
</td>
<td style="text-align:right;">
0.6531614
</td>
<td style="text-align:right;">
0.0023454426
</td>
<td style="text-align:right;">
0.0027577101
</td>
<td style="text-align:right;">
0.005158307
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.604624225
</td>
<td style="text-align:right;">
0.02754320
</td>
<td style="text-align:right;">
-21.95184891
</td>
<td style="text-align:right;">
38.660545
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
-0.6603513
</td>
<td style="text-align:right;">
-0.5488972
</td>
<td style="text-align:right;">
1.1193151
</td>
<td style="text-align:right;">
0.5281494
</td>
<td style="text-align:right;">
0.5508016
</td>
<td style="text-align:right;">
0.0003579590
</td>
<td style="text-align:right;">
0.0003928127
</td>
<td style="text-align:right;">
0.000758628
</td>
<td style="text-align:right;">
107
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095397
</td>
<td style="text-align:right;">
0.27347617
</td>
<td style="text-align:right;">
7.64269662
</td>
<td style="text-align:right;">
44.957637
</td>
<td style="text-align:right;">
0.0000000012
</td>
<td style="text-align:right;">
1.5392718
</td>
<td style="text-align:right;">
2.6409190
</td>
<td style="text-align:right;">
0.8374225
</td>
<td style="text-align:right;">
0.4557593
</td>
<td style="text-align:right;">
0.4784561
</td>
<td style="text-align:right;">
0.0407033312
</td>
<td style="text-align:right;">
0.0334175334
</td>
<td style="text-align:right;">
0.074789215
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.237421364
</td>
<td style="text-align:right;">
0.03681974
</td>
<td style="text-align:right;">
6.44820812
</td>
<td style="text-align:right;">
77.603129
</td>
<td style="text-align:right;">
0.0000000088
</td>
<td style="text-align:right;">
0.1641130
</td>
<td style="text-align:right;">
0.3107297
</td>
<td style="text-align:right;">
3.0345631
</td>
<td style="text-align:right;">
0.7521417
</td>
<td style="text-align:right;">
0.7582918
</td>
<td style="text-align:right;">
0.0003360199
</td>
<td style="text-align:right;">
0.0009996800
</td>
<td style="text-align:right;">
0.001355693
</td>
<td style="text-align:right;">
3011
</td>
</tr>
</tbody>
</table>
</div>
<p>Comparing both approaches to the Stata results gives almost identical estimations.</p>
<pre><code>. mi estimate: mean g_p [aw = pondera],over(mobility_pred)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      3,326
                                  Average RVI     =     2.2503
                                  Largest FMI     =     0.7617
                                  Complete DF     =       3325
DF adjustment:   Small sample     DF:     min     =      77.58
                                          avg     =      97.73
Within VCE type:     Analytic             max     =     122.20

            1: mobility_pred = 1
            2: mobility_pred = 2
            3: mobility_pred = 3
            4: mobility_pred = 4

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
           1 |  -.0133056   .0718002     -.1556967    .1290856
           2 |  -.5893088   .0311675     -.6513639   -.5272538
           3 |   1.895496   .2997447      1.302131    2.488861
           4 |   .2248258   .0335358      .1581773    .2914743
--------------------------------------------------------------
Note: Numbers of observations in e(_N) vary among imputations.</code></pre>
<p>Using both adjustments does brings some bias to the results. Using option <code>use_random = TRUE</code> make means for the groups with the small number of observations vary from one iteration to another. Using <code>use_random = FALSE</code> produces consistent results but may bias the estimates. In any case, when we do inference on the group-wise statistics derived from the multiple imputations data set, we need to take all possible information into account especially, number of degrees of freedoms, confidence intervals and standard errors.</p>
<p>Below, we produce a table, where same statistics was calculated 10 times and estimation parameters were compared between two approaches. For the small sample, besides varying estimates we also find wide confidence intervals making out estimates insignificant</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred1
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate_fixed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error_fixed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %_fixed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %_fixed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom_fixed
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.012050570
</td>
<td style="text-align:right;">
0.09963980
</td>
<td style="text-align:right;">
-0.3288610
</td>
<td style="text-align:right;">
0.3047599
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008478421
</td>
<td style="text-align:right;">
0.07422637
</td>
<td style="text-align:right;">
-0.1941441
</td>
<td style="text-align:right;">
0.1771872
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.005972494
</td>
<td style="text-align:right;">
0.07430468
</td>
<td style="text-align:right;">
-0.1937304
</td>
<td style="text-align:right;">
0.1817854
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.012845347
</td>
<td style="text-align:right;">
0.07175433
</td>
<td style="text-align:right;">
-0.1913633
</td>
<td style="text-align:right;">
0.1656726
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.002218199
</td>
<td style="text-align:right;">
0.09830005
</td>
<td style="text-align:right;">
-0.3100977
</td>
<td style="text-align:right;">
0.3145341
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.003378081
</td>
<td style="text-align:right;">
0.08965305
</td>
<td style="text-align:right;">
-0.2497612
</td>
<td style="text-align:right;">
0.2565173
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.012506051
</td>
<td style="text-align:right;">
0.08969905
</td>
<td style="text-align:right;">
-0.2744245
</td>
<td style="text-align:right;">
0.2494124
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.004230328
</td>
<td style="text-align:right;">
0.07378396
</td>
<td style="text-align:right;">
-0.1745213
</td>
<td style="text-align:right;">
0.1829820
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.002131739
</td>
<td style="text-align:right;">
0.07748595
</td>
<td style="text-align:right;">
-0.1968335
</td>
<td style="text-align:right;">
0.1925700
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.003888532
</td>
<td style="text-align:right;">
0.08678996
</td>
<td style="text-align:right;">
-0.2457464
</td>
<td style="text-align:right;">
0.2379693
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008526435
</td>
<td style="text-align:right;">
0.07182135
</td>
<td style="text-align:right;">
-0.1888223
</td>
<td style="text-align:right;">
0.1717694
</td>
<td style="text-align:right;">
14
</td>
</tr>
</tbody>
</table>
</div>
<p>Same calculations for a group of slightly bigger size demonstrate significantly lower variability of estimates.</p>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom_random
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred1
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable1
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate_fixed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error_fixed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %_fixed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %_fixed
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom_fixed
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.181236
</td>
<td style="text-align:right;">
0.3852063
</td>
<td style="text-align:right;">
1.386844
</td>
<td style="text-align:right;">
2.975628
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.154306
</td>
<td style="text-align:right;">
0.3117651
</td>
<td style="text-align:right;">
1.520401
</td>
<td style="text-align:right;">
2.788211
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.197241
</td>
<td style="text-align:right;">
0.4014966
</td>
<td style="text-align:right;">
1.368737
</td>
<td style="text-align:right;">
3.025745
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.181907
</td>
<td style="text-align:right;">
0.2985650
</td>
<td style="text-align:right;">
1.579558
</td>
<td style="text-align:right;">
2.784257
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.161658
</td>
<td style="text-align:right;">
0.3703184
</td>
<td style="text-align:right;">
1.398771
</td>
<td style="text-align:right;">
2.924545
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.169280
</td>
<td style="text-align:right;">
0.3684983
</td>
<td style="text-align:right;">
1.411760
</td>
<td style="text-align:right;">
2.926799
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.189543
</td>
<td style="text-align:right;">
0.3598575
</td>
<td style="text-align:right;">
1.452609
</td>
<td style="text-align:right;">
2.926476
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.182316
</td>
<td style="text-align:right;">
0.3215778
</td>
<td style="text-align:right;">
1.530451
</td>
<td style="text-align:right;">
2.834181
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.176577
</td>
<td style="text-align:right;">
0.3289863
</td>
<td style="text-align:right;">
1.507536
</td>
<td style="text-align:right;">
2.845618
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.199486
</td>
<td style="text-align:right;">
0.3444188
</td>
<td style="text-align:right;">
1.496773
</td>
<td style="text-align:right;">
2.902200
</td>
<td style="text-align:right;">
104
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.090095
</td>
<td style="text-align:right;">
0.2734762
</td>
<td style="text-align:right;">
1.539272
</td>
<td style="text-align:right;">
2.640919
</td>
<td style="text-align:right;">
104
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="reproducing-mobility-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#reproducing-mobility-statistics" class="anchor"></a>Reproducing mobility statistics</h3>
<p>To help us with reproducing mobility we created several help functions. Below, we calculated state of poverty for 2 poverty lines and different incomes:</p>
<ul>
<li>
<code>ipcf</code> - the actually observed income from panel data and variable <code>poor_act</code>, <code>vul_act</code> and <code>mid_act</code> represent respective poverty categories.</li>
<li>
<code>ipcf_pred</code> - income predicted using the <code>lassopmm</code>
</li>
<li>
<code>ipcf_2014</code> - income in 2014 data (period 0 for our calculations).</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">pl_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">5.5</span> <span class="op">*</span><span class="st"> </span><span class="fl">30.41667</span></a>
<a class="sourceLine" id="cb15-2" title="2">pl_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="fl">30.41667</span></a>
<a class="sourceLine" id="cb15-3" title="3"></a>
<a class="sourceLine" id="cb15-4" title="4">poverty_calc &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="st">  </span>r_mi_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ipcf =</span> <span class="kw">if_else</span>(.imp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA_real_</span>, ipcf),</a>
<a class="sourceLine" id="cb15-7" title="7">         <span class="dt">ipcf_2014 =</span> <span class="kw">if_else</span>(.imp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA_real_</span>, ipcf_<span class="dv">2014</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf, <span class="st">"act"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf_pred, <span class="st">"pred"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf_<span class="dv">2014</span>, <span class="st">"2014"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="st">  </span><span class="kw">select</span>(.id, .imp, pondera, <span class="kw">contains</span>(<span class="st">"ipcf"</span>), </a>
<a class="sourceLine" id="cb15-12" title="12">         <span class="kw">contains</span>(<span class="st">"_act"</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">"_actual"</span>), </a>
<a class="sourceLine" id="cb15-13" title="13">         <span class="kw">contains</span>(<span class="st">"_pred"</span>), <span class="kw">contains</span>(<span class="st">"_2014"</span>))</a></code></pre></div>
<p>At the next step we find all combinations for the variables <code>poor_</code>, <code>vul_</code> and <code>mid_</code> between different periods and create corresponding dummy variables.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">poverty_calc2 &lt;-</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="st">  </span>poverty_calc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb16-4" title="4">    (.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="st">      </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_2014$"</span>), <span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_act$"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="st">      </span><span class="kw"><a href="../reference/get_all_combinations.html">get_all_combinations</a></span>(mAct)</a>
<a class="sourceLine" id="cb16-7" title="7">  )  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb16-9" title="9">    (.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="st">      </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_2014$"</span>), <span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_pred$"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="st">      </span><span class="kw"><a href="../reference/get_all_combinations.html">get_all_combinations</a></span>(mPred)</a>
<a class="sourceLine" id="cb16-12" title="12">  )</a></code></pre></div>
<p>Finally, we reproduce STATA analysis of the mobility.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">compare_vars &lt;-</a>
<a class="sourceLine" id="cb17-2" title="2"><span class="st">  </span>poverty_calc2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magrittr/topics/aliases">extract</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">"mAct_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>()</a>
<a class="sourceLine" id="cb17-6" title="6"></a>
<a class="sourceLine" id="cb17-7" title="7">arg_act_mob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb17-8" title="8"><span class="st">  </span>poverty_calc2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/get_mi_means_table.html">get_mi_means_table</a></span>(compare_vars, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-10" title="10"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ubar, <span class="op">-</span>t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-11" title="11"><span class="st">  </span><span class="kw">arrange</span>(variable) </a>
<a class="sourceLine" id="cb17-12" title="12"></a>
<a class="sourceLine" id="cb17-13" title="13">arg_act_mob <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb17-14" title="14"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mAct_1poor_1poor
</td>
<td style="text-align:right;">
0.019222421
</td>
<td style="text-align:right;">
0.002381187
</td>
<td style="text-align:right;">
8.072622
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
0.0000e+00
</td>
<td style="text-align:right;">
0.014553680
</td>
<td style="text-align:right;">
0.023891162
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_1poor_2vul
</td>
<td style="text-align:right;">
0.040982561
</td>
<td style="text-align:right;">
0.003438088
</td>
<td style="text-align:right;">
11.920161
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
0.0000e+00
</td>
<td style="text-align:right;">
0.034241577
</td>
<td style="text-align:right;">
0.047723545
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_1poor_3mid
</td>
<td style="text-align:right;">
0.012259249
</td>
<td style="text-align:right;">
0.001908348
</td>
<td style="text-align:right;">
6.424011
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
2.0000e-10
</td>
<td style="text-align:right;">
0.008517593
</td>
<td style="text-align:right;">
0.016000906
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_1poor
</td>
<td style="text-align:right;">
0.019992089
</td>
<td style="text-align:right;">
0.002427437
</td>
<td style="text-align:right;">
8.235882
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
0.0000e+00
</td>
<td style="text-align:right;">
0.015232665
</td>
<td style="text-align:right;">
0.024751512
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_2vul
</td>
<td style="text-align:right;">
0.197464667
</td>
<td style="text-align:right;">
0.006903685
</td>
<td style="text-align:right;">
28.602793
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
0.0000e+00
</td>
<td style="text-align:right;">
0.183928763
</td>
<td style="text-align:right;">
0.211000571
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_3mid
</td>
<td style="text-align:right;">
0.095835846
</td>
<td style="text-align:right;">
0.005104954
</td>
<td style="text-align:right;">
18.773108
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
0.0000e+00
</td>
<td style="text-align:right;">
0.085826674
</td>
<td style="text-align:right;">
0.105845017
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_1poor
</td>
<td style="text-align:right;">
0.006280695
</td>
<td style="text-align:right;">
0.001370061
</td>
<td style="text-align:right;">
4.584245
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
4.7242e-06
</td>
<td style="text-align:right;">
0.003594446
</td>
<td style="text-align:right;">
0.008966943
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_2vul
</td>
<td style="text-align:right;">
0.076522379
</td>
<td style="text-align:right;">
0.004610113
</td>
<td style="text-align:right;">
16.598807
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
0.0000e+00
</td>
<td style="text-align:right;">
0.067483431
</td>
<td style="text-align:right;">
0.085561328
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_3mid
</td>
<td style="text-align:right;">
0.531440094
</td>
<td style="text-align:right;">
0.008653940
</td>
<td style="text-align:right;">
61.410187
</td>
<td style="text-align:right;">
3322.667
</td>
<td style="text-align:right;">
0.0000e+00
</td>
<td style="text-align:right;">
0.514472502
</td>
<td style="text-align:right;">
0.548407686
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
3325
</td>
</tr>
</tbody>
</table>
</div>
<p>R estimations are very close to Stata results.</p>
<pre><code>--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
   pp_actual |   .0192224   .0023812      .0145537    .0238912
   pv_actual |   .0409826   .0034381      .0342416    .0477235
   pm_actual |   .0122592   .0019083      .0085176    .0160009
   vp_actual |   .0199921   .0024274      .0152327    .0247515
   vv_actual |   .1974647   .0069037      .1839288    .2110006
   vm_actual |   .0958358    .005105      .0858267     .105845
   mp_actual |   .0062807   .0013701      .0035944    .0089669
   mv_actual |   .0765224   .0046101      .0674834    .0855613
   mm_actual |   .5314401   .0086539      .5144725    .5484077
--------------------------------------------------------------</code></pre>
<p>Do the same for predicted poverty.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">compare_vars2 &lt;-</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="st">  </span>poverty_calc2 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-4" title="4"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magrittr/topics/aliases">extract</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">"mPred_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>()</a>
<a class="sourceLine" id="cb19-6" title="6"></a>
<a class="sourceLine" id="cb19-7" title="7">arg_pred_mob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb19-8" title="8"><span class="st">  </span>poverty_calc2 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/get_mi_means_table.html">get_mi_means_table</a></span>(compare_vars2, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb19-10" title="10"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ubar, <span class="op">-</span>t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="st">  </span><span class="kw">arrange</span>(variable) </a>
<a class="sourceLine" id="cb19-12" title="12">arg_pred_mob <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb19-13" title="13"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mPred_1poor_1poor
</td>
<td style="text-align:right;">
0.009312932
</td>
<td style="text-align:right;">
0.003244433
</td>
<td style="text-align:right;">
2.870435
</td>
<td style="text-align:right;">
81.86111
</td>
<td style="text-align:right;">
0.0052153690
</td>
<td style="text-align:right;">
0.002858558
</td>
<td style="text-align:right;">
0.01576731
</td>
<td style="text-align:right;">
2.796619
</td>
<td style="text-align:right;">
0.7366078
</td>
<td style="text-align:right;">
0.7428154
</td>
<td style="text-align:right;">
0.0000076018
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_1poor_2vul
</td>
<td style="text-align:right;">
0.033874083
</td>
<td style="text-align:right;">
0.004966376
</td>
<td style="text-align:right;">
6.820684
</td>
<td style="text-align:right;">
123.01849
</td>
<td style="text-align:right;">
0.0000000004
</td>
<td style="text-align:right;">
0.024043461
</td>
<td style="text-align:right;">
0.04370471
</td>
<td style="text-align:right;">
1.507025
</td>
<td style="text-align:right;">
0.6011208
</td>
<td style="text-align:right;">
0.6074513
</td>
<td style="text-align:right;">
0.0000145359
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_1poor_3mid
</td>
<td style="text-align:right;">
0.029277215
</td>
<td style="text-align:right;">
0.004781366
</td>
<td style="text-align:right;">
6.123190
</td>
<td style="text-align:right;">
113.50079
</td>
<td style="text-align:right;">
0.0000000135
</td>
<td style="text-align:right;">
0.019804919
</td>
<td style="text-align:right;">
0.03874951
</td>
<td style="text-align:right;">
1.675968
</td>
<td style="text-align:right;">
0.6263035
</td>
<td style="text-align:right;">
0.6327188
</td>
<td style="text-align:right;">
0.0000140375
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_1poor
</td>
<td style="text-align:right;">
0.038349141
</td>
<td style="text-align:right;">
0.006554511
</td>
<td style="text-align:right;">
5.850801
</td>
<td style="text-align:right;">
80.61880
</td>
<td style="text-align:right;">
0.0000001007
</td>
<td style="text-align:right;">
0.025306784
</td>
<td style="text-align:right;">
0.05139150
</td>
<td style="text-align:right;">
2.876681
</td>
<td style="text-align:right;">
0.7420474
</td>
<td style="text-align:right;">
0.7482171
</td>
<td style="text-align:right;">
0.0000312545
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_2vul
</td>
<td style="text-align:right;">
0.149344417
</td>
<td style="text-align:right;">
0.009961198
</td>
<td style="text-align:right;">
14.992616
</td>
<td style="text-align:right;">
117.59551
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.129617830
</td>
<td style="text-align:right;">
0.16907100
</td>
<td style="text-align:right;">
1.598200
</td>
<td style="text-align:right;">
0.6151181
</td>
<td style="text-align:right;">
0.6215011
</td>
<td style="text-align:right;">
0.0000598386
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_3mid
</td>
<td style="text-align:right;">
0.125599044
</td>
<td style="text-align:right;">
0.011046664
</td>
<td style="text-align:right;">
11.369862
</td>
<td style="text-align:right;">
83.51118
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.103629662
</td>
<td style="text-align:right;">
0.14756843
</td>
<td style="text-align:right;">
2.697391
</td>
<td style="text-align:right;">
0.7295390
</td>
<td style="text-align:right;">
0.7357916
</td>
<td style="text-align:right;">
0.0000872792
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_1poor
</td>
<td style="text-align:right;">
0.019655098
</td>
<td style="text-align:right;">
0.004605382
</td>
<td style="text-align:right;">
4.267854
</td>
<td style="text-align:right;">
84.11920
</td>
<td style="text-align:right;">
0.0000515111
</td>
<td style="text-align:right;">
0.010496980
</td>
<td style="text-align:right;">
0.02881321
</td>
<td style="text-align:right;">
2.662713
</td>
<td style="text-align:right;">
0.7269783
</td>
<td style="text-align:right;">
0.7332461
</td>
<td style="text-align:right;">
0.0000151165
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_2vul
</td>
<td style="text-align:right;">
0.140713282
</td>
<td style="text-align:right;">
0.012171128
</td>
<td style="text-align:right;">
11.561236
</td>
<td style="text-align:right;">
77.80889
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.116481490
</td>
<td style="text-align:right;">
0.16494507
</td>
<td style="text-align:right;">
3.077238
</td>
<td style="text-align:right;">
0.7547360
</td>
<td style="text-align:right;">
0.7608062
</td>
<td style="text-align:right;">
0.0001096116
</td>
<td style="text-align:right;">
3325
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_3mid
</td>
<td style="text-align:right;">
0.453874788
</td>
<td style="text-align:right;">
0.013640051
</td>
<td style="text-align:right;">
33.275153
</td>
<td style="text-align:right;">
123.67446
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.426876606
</td>
<td style="text-align:right;">
0.48087297
</td>
<td style="text-align:right;">
1.496797
</td>
<td style="text-align:right;">
0.5994868
</td>
<td style="text-align:right;">
0.6058103
</td>
<td style="text-align:right;">
0.0001093482
</td>
<td style="text-align:right;">
3325
</td>
</tr>
</tbody>
</table>
</div>
<p>R estimations are very close to Stata results.</p>
<pre><code>--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
     pp_pred |   .0085054   .0027571      .0030355    .0139753
     pv_pred |   .0344468   .0085182      .0173932    .0515004
     pm_pred |    .022895   .0053952      .0121467    .0336432
     vp_pred |   .0245613   .0041501      .0163515    .0327712
     vv_pred |   .1468161   .0122115      .1225115    .1711207
     vm_pred |   .1527355   .0138703      .1250653    .1804057
     mp_pred |   .0124284   .0029449      .0066041    .0182527
     mv_pred |   .1337067   .0113548       .111124    .1562894
     mm_pred |   .4639047   .0151053      .4339309    .4938786
--------------------------------------------------------------
</code></pre>
</div>
</div>
<div id="chile-example" class="section level2">
<h2 class="hasAnchor">
<a href="#chile-example" class="anchor"></a>Chile example</h2>
<p>For Chile we perfom same analysis as for Argentina, but this time with less explanations.</p>
<p>Loading data</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">chile_period0 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span>(<span class="st">"DATA LOCATION 0.dta"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/zap_labels.html">zap_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pondera =</span> pondera <span class="op">*</span><span class="st"> </span>miembros)</a>
<a class="sourceLine" id="cb21-5" title="5">chile_period1 &lt;-</a>
<a class="sourceLine" id="cb21-6" title="6"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span>(<span class="st">"DATA LOCATION 1.dta"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/zap_labels.html">zap_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pondera =</span> pondera <span class="op">*</span><span class="st"> </span>miembros)</a></code></pre></div>
<p>Initializing analysis:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">dependent_var &lt;-<span class="st"> "lipcf"</span></a>
<a class="sourceLine" id="cb22-2" title="2">independent_vars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb22-3" title="3"><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"hombre"</span>, <span class="st">"aedu"</span>, <span class="st">"miembros"</span>, <span class="st">"miembros2"</span>, <span class="st">"urbano"</span>, </a>
<a class="sourceLine" id="cb22-4" title="4">   <span class="st">"region1"</span>, <span class="st">"region2"</span>, <span class="st">"region3"</span>, <span class="st">"region4"</span>, <span class="st">"region5"</span>, <span class="st">"region6"</span>, </a>
<a class="sourceLine" id="cb22-5" title="5">   <span class="st">"region7"</span>, <span class="st">"region8"</span>, <span class="st">"region9"</span>, <span class="st">"region10"</span>, <span class="st">"region11"</span>, <span class="st">"region12"</span>, <span class="st">"region13"</span>,</a>
<a class="sourceLine" id="cb22-6" title="6">   <span class="st">"hombre_region"</span>, <span class="st">"hombre_region1"</span>, <span class="st">"hombre_region2"</span>, <span class="st">"hombre_region3"</span>, </a>
<a class="sourceLine" id="cb22-7" title="7">   <span class="st">"hombre_region4"</span>, <span class="st">"hombre_region5"</span>, <span class="st">"hombre_region6"</span>, <span class="st">"hombre_region7"</span>, </a>
<a class="sourceLine" id="cb22-8" title="8">   <span class="st">"hombre_region8"</span>, <span class="st">"hombre_region9"</span>, <span class="st">"hombre_region10"</span>, <span class="st">"hombre_region11"</span>,</a>
<a class="sourceLine" id="cb22-9" title="9">   <span class="st">"hombre_region12"</span>, <span class="st">"hombre_region13"</span>, </a>
<a class="sourceLine" id="cb22-10" title="10">   <span class="st">"aedu_region"</span>, <span class="st">"aedu_region1"</span>, <span class="st">"aedu_region2"</span>, <span class="st">"aedu_region3"</span>, </a>
<a class="sourceLine" id="cb22-11" title="11">   <span class="st">"aedu_region4"</span>, <span class="st">"aedu_region5"</span>, <span class="st">"aedu_region6"</span>, <span class="st">"aedu_region7"</span>,</a>
<a class="sourceLine" id="cb22-12" title="12">   <span class="st">"aedu_region8"</span>, <span class="st">"aedu_region9"</span>, <span class="st">"aedu_region10"</span>, <span class="st">"aedu_region11"</span>,</a>
<a class="sourceLine" id="cb22-13" title="13">   <span class="st">"aedu_region12"</span>, <span class="st">"aedu_region13"</span>, </a>
<a class="sourceLine" id="cb22-14" title="14">   <span class="st">"miembros_region"</span>, <span class="st">"miembros_region1"</span>, <span class="st">"miembros_region2"</span>, <span class="st">"miembros_region3"</span>,</a>
<a class="sourceLine" id="cb22-15" title="15">   <span class="st">"miembros_region4"</span>, <span class="st">"miembros_region5"</span>, <span class="st">"miembros_region6"</span>, <span class="st">"miembros_region7"</span>,</a>
<a class="sourceLine" id="cb22-16" title="16">   <span class="st">"miembros_region8"</span>, <span class="st">"miembros_region9"</span>, <span class="st">"miembros_region10"</span>, <span class="st">"miembros_region11"</span>,</a>
<a class="sourceLine" id="cb22-17" title="17">   <span class="st">"miembros_region"</span>, <span class="st">"miembros_region13"</span>, </a>
<a class="sourceLine" id="cb22-18" title="18">   <span class="st">"miembros2_region"</span>, <span class="st">"miembros2_region1"</span>, <span class="st">"miembros2_region2"</span>, <span class="st">"miembros2_region3"</span>,</a>
<a class="sourceLine" id="cb22-19" title="19">   <span class="st">"miembros2_region4"</span>, <span class="st">"miembros2_region5"</span>, <span class="st">"miembros2_region6"</span>, <span class="st">"miembros2_region7"</span>,</a>
<a class="sourceLine" id="cb22-20" title="20">   <span class="st">"miembros2_region8"</span>, <span class="st">"miembros2_region9"</span>, <span class="st">"miembros2_region10"</span>, <span class="st">"miembros2_region11"</span>,</a>
<a class="sourceLine" id="cb22-21" title="21">   <span class="st">"miembros2_region12"</span>, <span class="st">"miembros2_region13"</span>, </a>
<a class="sourceLine" id="cb22-22" title="22">   <span class="st">"urbano_region"</span>, <span class="st">"urbano_region1"</span>, <span class="st">"urbano_region2"</span>, <span class="st">"urbano_region3"</span>, </a>
<a class="sourceLine" id="cb22-23" title="23">   <span class="st">"urbano_region4"</span>, <span class="st">"urbano_region5"</span>, <span class="st">"urbano_region6"</span>, <span class="st">"urbano_region7"</span>,</a>
<a class="sourceLine" id="cb22-24" title="24">   <span class="st">"urbano_region8"</span>, <span class="st">"urbano_region9"</span>, <span class="st">"urbano_region10"</span>, <span class="st">"urbano_region11"</span>,</a>
<a class="sourceLine" id="cb22-25" title="25">   <span class="st">"urbano_region12"</span>, <span class="st">"urbano_region13"</span>, </a>
<a class="sourceLine" id="cb22-26" title="26">   <span class="st">"edad"</span>, <span class="st">"edad2"</span>, </a>
<a class="sourceLine" id="cb22-27" title="27">   <span class="st">"edad_region"</span>, <span class="st">"edad_region1"</span>, <span class="st">"edad_region2"</span>, <span class="st">"edad_region3"</span>, </a>
<a class="sourceLine" id="cb22-28" title="28">   <span class="st">"edad_region4"</span>, <span class="st">"edad_region5"</span>, <span class="st">"edad_region6"</span>, <span class="st">"edad_region7"</span>,</a>
<a class="sourceLine" id="cb22-29" title="29">   <span class="st">"edad_region8"</span>, <span class="st">"edad_region9"</span>, <span class="st">"edad_region10"</span>, <span class="st">"edad_region11"</span>, </a>
<a class="sourceLine" id="cb22-30" title="30">   <span class="st">"edad_region12"</span>, <span class="st">"edad_region13"</span>,</a>
<a class="sourceLine" id="cb22-31" title="31">   <span class="st">"edad2_region"</span>, <span class="st">"edad2_region1"</span>, <span class="st">"edad2_region2"</span>, <span class="st">"edad2_region3"</span>, </a>
<a class="sourceLine" id="cb22-32" title="32">   <span class="st">"edad2_region4"</span>, <span class="st">"edad2_region5"</span>, <span class="st">"edad2_region6"</span>, <span class="st">"edad2_region7"</span>, </a>
<a class="sourceLine" id="cb22-33" title="33">   <span class="st">"edad2_region8"</span>, <span class="st">"edad2_region9"</span>, <span class="st">"edad2_region10"</span>, <span class="st">"edad2_region11"</span>, </a>
<a class="sourceLine" id="cb22-34" title="34">   <span class="st">"edad2_region12"</span>, <span class="st">"edad2_region13"</span>)</a>
<a class="sourceLine" id="cb22-35" title="35">weight_var &lt;-<span class="st"> "pondera"</span></a>
<a class="sourceLine" id="cb22-36" title="36">n_iterations &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb22-37" title="37">n_nearest &lt;-<span class="st"> </span><span class="dv">10</span></a></code></pre></div>
<p>Running the analysis is made in one command:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">238</span>)</a>
<a class="sourceLine" id="cb23-2" title="2">chile_mi_data_raw &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/lassopmm.html">lassopmm</a></span>(chile_period1, </a>
<a class="sourceLine" id="cb23-4" title="4">           chile_period0, </a>
<a class="sourceLine" id="cb23-5" title="5">           <span class="dt">dep_var =</span> dependent_var, </a>
<a class="sourceLine" id="cb23-6" title="6">           <span class="dt">indep_var =</span> independent_vars, </a>
<a class="sourceLine" id="cb23-7" title="7">           <span class="dt">weight_var =</span> weight_var, </a>
<a class="sourceLine" id="cb23-8" title="8">           <span class="dt">n_near =</span> n_nearest, </a>
<a class="sourceLine" id="cb23-9" title="9">           <span class="dt">n_boot =</span> n_iterations)</a></code></pre></div>
<p>Calculating all variable:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">chile_mi_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="st">  </span>chile_mi_data_raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb24-4" title="4">    <span class="dt">ipcf_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(lipcf_source),</a>
<a class="sourceLine" id="cb24-5" title="5">    <span class="dt">perc =</span> statar<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/statar/topics/xtile">xtile</a></span>(ipcf, <span class="dt">wt =</span> pondera, <span class="dt">n =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb24-6" title="6">    <span class="dt">g_a =</span> (ipcf_<span class="dv">2012</span><span class="op">/</span>ipcf) <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="dv">2011</span> <span class="op">-</span><span class="st"> </span><span class="dv">2012</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb24-7" title="7">    <span class="dt">g_p =</span> (ipcf_pred<span class="op">/</span>ipcf) <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(<span class="dv">2011</span> <span class="op">-</span><span class="st"> </span><span class="dv">2012</span>)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb24-8" title="8">    <span class="dt">poor_pred =</span> <span class="kw">if_else</span>(lipcf_source <span class="op">&lt;</span><span class="st"> </span>lpl, <span class="dv">1</span>, <span class="dv">0</span>, <span class="ot">NA_real_</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-9" title="9"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb24-10" title="10">    <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb24-11" title="11">      <span class="dt">poor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb24-12" title="12">      <span class="dt">poor_2012 =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb24-13" title="13">      <span class="dt">mobility_actual =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb24-14" title="14">    ), </a>
<a class="sourceLine" id="cb24-15" title="15">    <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"poor"</span>, <span class="st">"poor_2012"</span>)</a>
<a class="sourceLine" id="cb24-16" title="16">  )<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb24-17" title="17"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb24-18" title="18">    <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb24-19" title="19">      <span class="dt">poor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb24-20" title="20">      <span class="dt">poor_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb24-21" title="21">      <span class="dt">mobility_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb24-22" title="22">    ), </a>
<a class="sourceLine" id="cb24-23" title="23">    <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"poor"</span>, <span class="st">"poor_pred"</span>)</a>
<a class="sourceLine" id="cb24-24" title="24">  )</a></code></pre></div>
<div id="mi-estimate-mean-g_a-g_p-aw-ponderaoverperc" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_a-g_p-aw-ponderaoverperc" class="anchor"></a><code>mi estimate: mean g_a g_p [aw = pondera],over(perc)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb25-2" title="2">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(chile_mi_data, <span class="st">"g_a"</span>, <span class="st">"perc"</span>, <span class="st">"pondera"</span>),</a>
<a class="sourceLine" id="cb25-3" title="3">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(chile_mi_data, <span class="st">"g_p"</span>, <span class="st">"perc"</span>, <span class="st">"pondera"</span>)</a>
<a class="sourceLine" id="cb25-4" title="4">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb25-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
perc
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.59492042
</td>
<td style="text-align:right;">
0.03682505
</td>
<td style="text-align:right;">
16.155321
</td>
<td style="text-align:right;">
691.93931
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.52261819
</td>
<td style="text-align:right;">
0.66722265
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.002877949
</td>
<td style="text-align:right;">
0.0013560839
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0013560839
</td>
<td style="text-align:right;">
694
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.27152916
</td>
<td style="text-align:right;">
0.03233092
</td>
<td style="text-align:right;">
8.398435
</td>
<td style="text-align:right;">
761.93150
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.20806090
</td>
<td style="text-align:right;">
0.33499743
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.002614613
</td>
<td style="text-align:right;">
0.0010452886
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0010452886
</td>
<td style="text-align:right;">
764
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.14896670
</td>
<td style="text-align:right;">
0.02367127
</td>
<td style="text-align:right;">
6.293143
</td>
<td style="text-align:right;">
848.92198
</td>
<td style="text-align:right;">
0.0000000005
</td>
<td style="text-align:right;">
0.10250562
</td>
<td style="text-align:right;">
0.19542778
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.002347633
</td>
<td style="text-align:right;">
0.0005603291
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0005603291
</td>
<td style="text-align:right;">
851
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.06540887
</td>
<td style="text-align:right;">
0.01805272
</td>
<td style="text-align:right;">
3.623215
</td>
<td style="text-align:right;">
927.91345
</td>
<td style="text-align:right;">
0.0003067570
</td>
<td style="text-align:right;">
0.02997999
</td>
<td style="text-align:right;">
0.10083776
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.002148427
</td>
<td style="text-align:right;">
0.0003259005
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0003259005
</td>
<td style="text-align:right;">
930
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.02335965
</td>
<td style="text-align:right;">
0.02310450
</td>
<td style="text-align:right;">
-1.011043
</td>
<td style="text-align:right;">
909.91539
</td>
<td style="text-align:right;">
0.3122645462
</td>
<td style="text-align:right;">
-0.06870395
</td>
<td style="text-align:right;">
0.02198466
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.002190784
</td>
<td style="text-align:right;">
0.0005338179
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0005338179
</td>
<td style="text-align:right;">
912
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
1.40897929
</td>
<td style="text-align:right;">
0.12676308
</td>
<td style="text-align:right;">
11.115060
</td>
<td style="text-align:right;">
68.04634
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
1.15603062
</td>
<td style="text-align:right;">
1.66192796
</td>
<td style="text-align:right;">
2.303337
</td>
<td style="text-align:right;">
0.6972758
</td>
<td style="text-align:right;">
0.705797700
</td>
<td style="text-align:right;">
0.0048644380
</td>
<td style="text-align:right;">
0.0109847454
</td>
<td style="text-align:right;">
0.0160688783
</td>
<td style="text-align:right;">
694
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.81863821
</td>
<td style="text-align:right;">
0.11461720
</td>
<td style="text-align:right;">
7.142368
</td>
<td style="text-align:right;">
54.40520
</td>
<td style="text-align:right;">
0.0000000023
</td>
<td style="text-align:right;">
0.58888374
</td>
<td style="text-align:right;">
1.04839268
</td>
<td style="text-align:right;">
3.545163
</td>
<td style="text-align:right;">
0.7799859
</td>
<td style="text-align:right;">
0.787651174
</td>
<td style="text-align:right;">
0.0028903484
</td>
<td style="text-align:right;">
0.0100458385
</td>
<td style="text-align:right;">
0.0131371037
</td>
<td style="text-align:right;">
764
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.33361249
</td>
<td style="text-align:right;">
0.06091511
</td>
<td style="text-align:right;">
5.476679
</td>
<td style="text-align:right;">
73.38926
</td>
<td style="text-align:right;">
0.0000005786
</td>
<td style="text-align:right;">
0.21221970
</td>
<td style="text-align:right;">
0.45500528
</td>
<td style="text-align:right;">
2.254297
</td>
<td style="text-align:right;">
0.6927139
</td>
<td style="text-align:right;">
0.700759194
</td>
<td style="text-align:right;">
0.0011402312
</td>
<td style="text-align:right;">
0.0025200187
</td>
<td style="text-align:right;">
0.0037106503
</td>
<td style="text-align:right;">
851
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.07076944
</td>
<td style="text-align:right;">
0.04786043
</td>
<td style="text-align:right;">
1.478663
</td>
<td style="text-align:right;">
74.71845
</td>
<td style="text-align:right;">
0.1434339766
</td>
<td style="text-align:right;">
-0.02457931
</td>
<td style="text-align:right;">
0.16611819
</td>
<td style="text-align:right;">
2.276772
</td>
<td style="text-align:right;">
0.6948217
</td>
<td style="text-align:right;">
0.702675085
</td>
<td style="text-align:right;">
0.0006990478
</td>
<td style="text-align:right;">
0.0015603655
</td>
<td style="text-align:right;">
0.0022906207
</td>
<td style="text-align:right;">
930
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.31987165
</td>
<td style="text-align:right;">
0.03463850
</td>
<td style="text-align:right;">
-9.234570
</td>
<td style="text-align:right;">
65.25368
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
-0.38904441
</td>
<td style="text-align:right;">
-0.25069889
</td>
<td style="text-align:right;">
2.821652
</td>
<td style="text-align:right;">
0.7383330
</td>
<td style="text-align:right;">
0.746000523
</td>
<td style="text-align:right;">
0.0003139547
</td>
<td style="text-align:right;">
0.0008685009
</td>
<td style="text-align:right;">
0.0011998256
</td>
<td style="text-align:right;">
912
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. mi estimate: mean g_a g_p [aw = pondera],over(perc)
(system variable _mi_id updated due to changed number of obs.)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      4,156
                                  Average RVI     =     1.2479
                                  Largest FMI     =     0.7653
                                  Complete DF     =       4155
DF adjustment:   Small sample     DF:     min     =      78.29
                                          avg     =   2,122.12
Within VCE type:     Analytic             max     =   4,153.00

            1: perc = 1
            2: perc = 2
            3: perc = 3
            4: perc = 4
            5: perc = 5

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
g_a          |
           1 |   .5949204    .036825      .5227236    .6671172
           2 |   .2715292   .0323309      .2081432    .3349151
           3 |   .1489667   .0236713      .1025583    .1953751
           4 |   .0654089   .0180527      .0300159    .1008019
           5 |  -.0233596   .0231045     -.0686568    .0219375
-------------+------------------------------------------------
g_p          |
           1 |   1.437587   .1337179      1.171985     1.70319
           2 |   .8113949    .093968      .6249553    .9978345
           3 |   .3304916   .0641439      .2029623    .4580209
           4 |    .078469   .0467262     -.0142149    .1711528
           5 |  -.3150302   .0369235     -.3885349   -.2415254
--------------------------------------------------------------</code></pre>
</div>
<div id="mi-estimate-mean-g_a-aw-ponderaovermobility_actual" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_a-aw-ponderaovermobility_actual" class="anchor"></a><code>mi estimate: mean g_a [aw = pondera],over(mobility_actual)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(chile_mi_data, <span class="st">"g_a"</span>, <span class="st">"mobility_actual"</span>, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-2" title="2"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_actual
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.01868159
</td>
<td style="text-align:right;">
0.02240651
</td>
<td style="text-align:right;">
0.8337574
</td>
<td style="text-align:right;">
196.0102
</td>
<td style="text-align:right;">
0.4054326
</td>
<td style="text-align:right;">
-0.0255072
</td>
<td style="text-align:right;">
0.06287039
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0100497341
</td>
<td style="text-align:right;">
0.0005020518
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0005020518
</td>
<td style="text-align:right;">
198
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.46900324
</td>
<td style="text-align:right;">
0.01234878
</td>
<td style="text-align:right;">
-37.9797145
</td>
<td style="text-align:right;">
272.9943
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.4933142
</td>
<td style="text-align:right;">
-0.44469229
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0072465274
</td>
<td style="text-align:right;">
0.0001524924
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0001524924
</td>
<td style="text-align:right;">
275
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
1.03156848
</td>
<td style="text-align:right;">
0.05810357
</td>
<td style="text-align:right;">
17.7539617
</td>
<td style="text-align:right;">
351.9816
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.9172947
</td>
<td style="text-align:right;">
1.14584231
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0056340952
</td>
<td style="text-align:right;">
0.0033760244
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0033760244
</td>
<td style="text-align:right;">
354
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.18483545
</td>
<td style="text-align:right;">
0.01272392
</td>
<td style="text-align:right;">
14.5266166
</td>
<td style="text-align:right;">
3322.6672
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.1598879
</td>
<td style="text-align:right;">
0.20978296
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0006013831
</td>
<td style="text-align:right;">
0.0001618980
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0001618980
</td>
<td style="text-align:right;">
3325
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. mi estimate: mean g_a [aw = pondera],over(mobility_actual)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      4,156
                                  Average RVI     =     0.0000
                                  Largest FMI     =     0.0000
                                  Complete DF     =       4155
DF adjustment:   Small sample     DF:     min     =   4,153.00
                                          avg     =   4,153.00
Within VCE type:     Analytic             max     =   4,153.00

            1: mobility_actual = 1
            2: mobility_actual = 2
            3: mobility_actual = 3
            4: mobility_actual = 4

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
           1 |   .0186816   .0224065     -.0252472    .0626104
           2 |  -.4690032   .0123488     -.4932135    -.444793
           3 |   1.031568   .0581036      .9176544    1.145483
           4 |   .1848355   .0127239      .1598898    .2097811
--------------------------------------------------------------</code></pre>
</div>
<div id="mi-estimate-mean-g_p-aw-ponderaovermobility_pred" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_p-aw-ponderaovermobility_pred" class="anchor"></a><code>mi estimate: mean g_p [aw = pondera],over(mobility_pred)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb29-2" title="2">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(chile_mi_data, <span class="st">"g_p"</span>, <span class="st">"mobility_pred"</span>, <span class="st">"pondera"</span>, <span class="dt">use_random =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb29-3" title="3">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(chile_mi_data, <span class="st">"g_p"</span>, <span class="st">"mobility_pred"</span>, <span class="st">"pondera"</span>, <span class="dt">use_random =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb29-4" title="4">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.04836561
</td>
<td style="text-align:right;">
0.05553799
</td>
<td style="text-align:right;">
0.8708562
</td>
<td style="text-align:right;">
19.98257
</td>
<td style="text-align:right;">
0.3941748
</td>
<td style="text-align:right;">
-0.06749109
</td>
<td style="text-align:right;">
0.1642223
</td>
<td style="text-align:right;">
1.894392
</td>
<td style="text-align:right;">
0.6545042
</td>
<td style="text-align:right;">
0.6845701
</td>
<td style="text-align:right;">
0.0010656708
</td>
<td style="text-align:right;">
0.0019792136
</td>
<td style="text-align:right;">
0.0030844687
</td>
<td style="text-align:right;">
72
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.54739104
</td>
<td style="text-align:right;">
0.02139258
</td>
<td style="text-align:right;">
-25.5878919
</td>
<td style="text-align:right;">
47.21739
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.59042213
</td>
<td style="text-align:right;">
-0.5043599
</td>
<td style="text-align:right;">
2.262026
</td>
<td style="text-align:right;">
0.6934420
</td>
<td style="text-align:right;">
0.7056513
</td>
<td style="text-align:right;">
0.0001402940
</td>
<td style="text-align:right;">
0.0003111260
</td>
<td style="text-align:right;">
0.0004576425
</td>
<td style="text-align:right;">
289
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.05016528
</td>
<td style="text-align:right;">
0.20999199
</td>
<td style="text-align:right;">
9.7630641
</td>
<td style="text-align:right;">
48.24349
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
1.62800312
</td>
<td style="text-align:right;">
2.4723274
</td>
<td style="text-align:right;">
3.012712
</td>
<td style="text-align:right;">
0.7507920
</td>
<td style="text-align:right;">
0.7605184
</td>
<td style="text-align:right;">
0.0109892342
</td>
<td style="text-align:right;">
0.0324582375
</td>
<td style="text-align:right;">
0.0440966364
</td>
<td style="text-align:right;">
437
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.32183639
</td>
<td style="text-align:right;">
0.03331375
</td>
<td style="text-align:right;">
9.6607665
</td>
<td style="text-align:right;">
95.59978
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.25570558
</td>
<td style="text-align:right;">
0.3879672
</td>
<td style="text-align:right;">
2.139745
</td>
<td style="text-align:right;">
0.6815028
</td>
<td style="text-align:right;">
0.6879632
</td>
<td style="text-align:right;">
0.0003534701
</td>
<td style="text-align:right;">
0.0007415059
</td>
<td style="text-align:right;">
0.0011098062
</td>
<td style="text-align:right;">
3200
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.05979300
</td>
<td style="text-align:right;">
0.05796180
</td>
<td style="text-align:right;">
1.0315933
</td>
<td style="text-align:right;">
19.15384
</td>
<td style="text-align:right;">
0.3151135
</td>
<td style="text-align:right;">
-0.06145652
</td>
<td style="text-align:right;">
0.1810425
</td>
<td style="text-align:right;">
2.019119
</td>
<td style="text-align:right;">
0.6687776
</td>
<td style="text-align:right;">
0.6986796
</td>
<td style="text-align:right;">
0.0011127649
</td>
<td style="text-align:right;">
0.0022027498
</td>
<td style="text-align:right;">
0.0033595697
</td>
<td style="text-align:right;">
72
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.54496885
</td>
<td style="text-align:right;">
0.01976692
</td>
<td style="text-align:right;">
-27.5697438
</td>
<td style="text-align:right;">
54.23120
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
-0.58459527
</td>
<td style="text-align:right;">
-0.5053424
</td>
<td style="text-align:right;">
1.836795
</td>
<td style="text-align:right;">
0.6474895
</td>
<td style="text-align:right;">
0.6598084
</td>
<td style="text-align:right;">
0.0001377368
</td>
<td style="text-align:right;">
0.0002480336
</td>
<td style="text-align:right;">
0.0003907310
</td>
<td style="text-align:right;">
289
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
2.07022863
</td>
<td style="text-align:right;">
0.19115721
</td>
<td style="text-align:right;">
10.8299792
</td>
<td style="text-align:right;">
55.76605
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
1.68725926
</td>
<td style="text-align:right;">
2.4531980
</td>
<td style="text-align:right;">
2.389044
</td>
<td style="text-align:right;">
0.7049315
</td>
<td style="text-align:right;">
0.7149736
</td>
<td style="text-align:right;">
0.0107821218
</td>
<td style="text-align:right;">
0.0252538803
</td>
<td style="text-align:right;">
0.0365410797
</td>
<td style="text-align:right;">
437
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.32915388
</td>
<td style="text-align:right;">
0.03704269
</td>
<td style="text-align:right;">
8.8857996
</td>
<td style="text-align:right;">
82.92329
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.25547646
</td>
<td style="text-align:right;">
0.4028313
</td>
<td style="text-align:right;">
2.714066
</td>
<td style="text-align:right;">
0.7307533
</td>
<td style="text-align:right;">
0.7370205
</td>
<td style="text-align:right;">
0.0003694497
</td>
<td style="text-align:right;">
0.0009830499
</td>
<td style="text-align:right;">
0.0013721605
</td>
<td style="text-align:right;">
3200
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. mi estimate: mean g_p [aw = pondera],over(mobility_pred)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      4,156
                                  Average RVI     =     1.9462
                                  Largest FMI     =     0.6842
                                  Complete DF     =       4155
DF adjustment:   Small sample     DF:     min     =      98.72
                                          avg     =     104.59
Within VCE type:     Analytic             max     =     114.86

            1: mobility_pred = 1
            2: mobility_pred = 2
            3: mobility_pred = 3
            4: mobility_pred = 4

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
           1 |    .036347   .0483942     -.0595139    .1322079
           2 |  -.5350016   .0193434      -.573377   -.4966262
           3 |    1.90831   .1699261      1.571128    2.245492
           4 |   .3443257   .0340776      .2767523    .4118991
--------------------------------------------------------------
Note: Numbers of observations in e(_N) vary among imputations.</code></pre>
</div>
<div id="poverty-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#poverty-analysis" class="anchor"></a>Poverty analysis</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">pl_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="dv">6</span> <span class="op">*</span><span class="st"> </span><span class="fl">30.41667</span></a>
<a class="sourceLine" id="cb31-2" title="2">pl_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="dv">14</span> <span class="op">*</span><span class="st"> </span><span class="fl">30.41667</span></a>
<a class="sourceLine" id="cb31-3" title="3"></a>
<a class="sourceLine" id="cb31-4" title="4">chile_poverty_calc &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="st">  </span>chile_mi_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ipcf =</span> <span class="kw">if_else</span>(.imp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA_real_</span>, ipcf),</a>
<a class="sourceLine" id="cb31-7" title="7">         <span class="dt">ipcf_2012 =</span> <span class="kw">if_else</span>(.imp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA_real_</span>, ipcf_<span class="dv">2012</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf, <span class="st">"act"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf_pred, <span class="st">"pred"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-10" title="10"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf_<span class="dv">2012</span>, <span class="st">"2012"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-11" title="11"><span class="st">  </span><span class="kw">select</span>(.id, .imp, pondera, <span class="kw">contains</span>(<span class="st">"ipcf"</span>), </a>
<a class="sourceLine" id="cb31-12" title="12">         <span class="kw">contains</span>(<span class="st">"_act"</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">"_actual"</span>), </a>
<a class="sourceLine" id="cb31-13" title="13">         <span class="kw">contains</span>(<span class="st">"_pred"</span>), <span class="kw">contains</span>(<span class="st">"_2012"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-14" title="14"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb31-15" title="15">    (.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-16" title="16"><span class="st">      </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_2012$"</span>), <span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_act$"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-17" title="17"><span class="st">      </span><span class="kw"><a href="../reference/get_all_combinations.html">get_all_combinations</a></span>(mAct)</a>
<a class="sourceLine" id="cb31-18" title="18">  )  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-19" title="19"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb31-20" title="20">    (.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-21" title="21"><span class="st">      </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_2012$"</span>), <span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_pred$"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb31-22" title="22"><span class="st">      </span><span class="kw"><a href="../reference/get_all_combinations.html">get_all_combinations</a></span>(mPred)</a>
<a class="sourceLine" id="cb31-23" title="23">  )</a></code></pre></div>
<div id="actual-mobility" class="section level4">
<h4 class="hasAnchor">
<a href="#actual-mobility" class="anchor"></a>Actual mobility</h4>
<p>R:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">compare_vars &lt;-</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">  </span>chile_poverty_calc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magrittr/topics/aliases">extract</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">"mAct_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>()</a>
<a class="sourceLine" id="cb32-6" title="6">chil_act_mob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb32-7" title="7"><span class="st">  </span>chile_poverty_calc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/get_mi_means_table.html">get_mi_means_table</a></span>(compare_vars, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-9" title="9"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ubar, <span class="op">-</span>t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-10" title="10"><span class="st">  </span><span class="kw">arrange</span>(variable) </a>
<a class="sourceLine" id="cb32-11" title="11">chil_act_mob <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb32-12" title="12"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mAct_1poor_1poor
</td>
<td style="text-align:right;">
0.012257347
</td>
<td style="text-align:right;">
0.001707004
</td>
<td style="text-align:right;">
7.180618
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.008910704
</td>
<td style="text-align:right;">
0.01560399
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_1poor_2vul
</td>
<td style="text-align:right;">
0.031367561
</td>
<td style="text-align:right;">
0.002704172
</td>
<td style="text-align:right;">
11.599690
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.026065936
</td>
<td style="text-align:right;">
0.03666919
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_1poor_3mid
</td>
<td style="text-align:right;">
0.009211361
</td>
<td style="text-align:right;">
0.001482064
</td>
<td style="text-align:right;">
6.215226
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
6.0e-10
</td>
<td style="text-align:right;">
0.006305722
</td>
<td style="text-align:right;">
0.01211700
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_1poor
</td>
<td style="text-align:right;">
0.031852095
</td>
<td style="text-align:right;">
0.002724296
</td>
<td style="text-align:right;">
11.691861
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.026511016
</td>
<td style="text-align:right;">
0.03719317
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_2vul
</td>
<td style="text-align:right;">
0.257226195
</td>
<td style="text-align:right;">
0.006781103
</td>
<td style="text-align:right;">
37.932793
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.243931602
</td>
<td style="text-align:right;">
0.27052079
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_3mid
</td>
<td style="text-align:right;">
0.075520323
</td>
<td style="text-align:right;">
0.004099162
</td>
<td style="text-align:right;">
18.423356
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.067483770
</td>
<td style="text-align:right;">
0.08355688
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_1poor
</td>
<td style="text-align:right;">
0.007878491
</td>
<td style="text-align:right;">
0.001371571
</td>
<td style="text-align:right;">
5.744135
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
9.9e-09
</td>
<td style="text-align:right;">
0.005189477
</td>
<td style="text-align:right;">
0.01056751
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_2vul
</td>
<td style="text-align:right;">
0.123614335
</td>
<td style="text-align:right;">
0.005106185
</td>
<td style="text-align:right;">
24.208746
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.113603479
</td>
<td style="text-align:right;">
0.13362519
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_3mid
</td>
<td style="text-align:right;">
0.451072292
</td>
<td style="text-align:right;">
0.007719606
</td>
<td style="text-align:right;">
58.432035
</td>
<td style="text-align:right;">
4152.583
</td>
<td style="text-align:right;">
0.0e+00
</td>
<td style="text-align:right;">
0.435937731
</td>
<td style="text-align:right;">
0.46620685
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0004812803
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
4155
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata (additional statistics is ommited):</p>
<pre><code>. local status "pp pv pm vp vv vm mp mv mm" 
. foreach x of local status {
  2.     local s = "`x'"
  3.         display "`s'"
  4.         mi estimate: mean `s'_actual [aw = pondera]
  5. }
--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
   pp_actual |   .0122573    .001707      .0089107     .015604
   pv_actual |   .0313676   .0027042      .0260659    .0366692
   pm_actual |   .0092114   .0014821      .0063057     .012117
   vp_actual |   .0318521   .0027243       .026511    .0371932
   vv_actual |   .2572262   .0067811      .2439316    .2705208
   vm_actual |   .0755203   .0040992      .0674838    .0835569
   mp_actual |   .0078785   .0013716      .0051895    .0105675
   mv_actual |   .1236143   .0051062      .1136035    .1336252
   mm_actual |   .4510723   .0077196      .4359377    .4662069
--------------------------------------------------------------
</code></pre>
</div>
<div id="predicted-mobility" class="section level4">
<h4 class="hasAnchor">
<a href="#predicted-mobility" class="anchor"></a>Predicted mobility</h4>
<p>R:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">compare_vars2 &lt;-</a>
<a class="sourceLine" id="cb34-2" title="2"><span class="st">  </span>chile_poverty_calc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb34-4" title="4"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magrittr/topics/aliases">extract</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">"mPred_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>()</a>
<a class="sourceLine" id="cb34-6" title="6">chil_pred_mob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb34-7" title="7"><span class="st">  </span>chile_poverty_calc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/get_mi_means_table.html">get_mi_means_table</a></span>(compare_vars2, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb34-9" title="9"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ubar, <span class="op">-</span>t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-10" title="10"><span class="st">  </span><span class="kw">arrange</span>(variable) </a>
<a class="sourceLine" id="cb34-11" title="11">chil_pred_mob <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb34-12" title="12"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mPred_1poor_1poor
</td>
<td style="text-align:right;">
0.002472535
</td>
<td style="text-align:right;">
0.001557224
</td>
<td style="text-align:right;">
1.587784
</td>
<td style="text-align:right;">
79.18051
</td>
<td style="text-align:right;">
0.1163206652
</td>
<td style="text-align:right;">
-0.0006269313
</td>
<td style="text-align:right;">
0.005572002
</td>
<td style="text-align:right;">
3.088046
</td>
<td style="text-align:right;">
0.7553844
</td>
<td style="text-align:right;">
0.7613375
</td>
<td style="text-align:right;">
1.79580e-06
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_1poor_2vul
</td>
<td style="text-align:right;">
0.024751081
</td>
<td style="text-align:right;">
0.003627428
</td>
<td style="text-align:right;">
6.823315
</td>
<td style="text-align:right;">
144.63408
</td>
<td style="text-align:right;">
0.0000000002
</td>
<td style="text-align:right;">
0.0175814643
</td>
<td style="text-align:right;">
0.031920697
</td>
<td style="text-align:right;">
1.265614
</td>
<td style="text-align:right;">
0.5586186
</td>
<td style="text-align:right;">
0.5645980
</td>
<td style="text-align:right;">
7.20630e-06
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_1poor_3mid
</td>
<td style="text-align:right;">
0.025612653
</td>
<td style="text-align:right;">
0.003658105
</td>
<td style="text-align:right;">
7.001617
</td>
<td style="text-align:right;">
148.39535
</td>
<td style="text-align:right;">
0.0000000001
</td>
<td style="text-align:right;">
0.0183839470
</td>
<td style="text-align:right;">
0.032841359
</td>
<td style="text-align:right;">
1.228541
</td>
<td style="text-align:right;">
0.5512759
</td>
<td style="text-align:right;">
0.5572038
</td>
<td style="text-align:right;">
7.23240e-06
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_1poor
</td>
<td style="text-align:right;">
0.018366294
</td>
<td style="text-align:right;">
0.004944742
</td>
<td style="text-align:right;">
3.714308
</td>
<td style="text-align:right;">
65.91046
</td>
<td style="text-align:right;">
0.0004217190
</td>
<td style="text-align:right;">
0.0084935472
</td>
<td style="text-align:right;">
0.028239041
</td>
<td style="text-align:right;">
4.640962
</td>
<td style="text-align:right;">
0.8227253
</td>
<td style="text-align:right;">
0.8278703
</td>
<td style="text-align:right;">
1.97216e-05
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_2vul
</td>
<td style="text-align:right;">
0.170768247
</td>
<td style="text-align:right;">
0.010826209
</td>
<td style="text-align:right;">
15.773596
</td>
<td style="text-align:right;">
90.10166
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.1492604243
</td>
<td style="text-align:right;">
0.192276070
</td>
<td style="text-align:right;">
2.441009
</td>
<td style="text-align:right;">
0.7093876
</td>
<td style="text-align:right;">
0.7156305
</td>
<td style="text-align:right;">
8.15148e-05
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_3mid
</td>
<td style="text-align:right;">
0.175464072
</td>
<td style="text-align:right;">
0.009919212
</td>
<td style="text-align:right;">
17.689317
</td>
<td style="text-align:right;">
108.64730
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.1558038007
</td>
<td style="text-align:right;">
0.195124343
</td>
<td style="text-align:right;">
1.826903
</td>
<td style="text-align:right;">
0.6462560
</td>
<td style="text-align:right;">
0.6525929
</td>
<td style="text-align:right;">
6.23388e-05
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_1poor
</td>
<td style="text-align:right;">
0.014378772
</td>
<td style="text-align:right;">
0.003979777
</td>
<td style="text-align:right;">
3.612959
</td>
<td style="text-align:right;">
73.04749
</td>
<td style="text-align:right;">
0.0005526676
</td>
<td style="text-align:right;">
0.0064471747
</td>
<td style="text-align:right;">
0.022310369
</td>
<td style="text-align:right;">
3.647536
</td>
<td style="text-align:right;">
0.7848322
</td>
<td style="text-align:right;">
0.7904910
</td>
<td style="text-align:right;">
1.21869e-05
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_2vul
</td>
<td style="text-align:right;">
0.168715259
</td>
<td style="text-align:right;">
0.010083386
</td>
<td style="text-align:right;">
16.732004
</td>
<td style="text-align:right;">
101.65874
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.1487141045
</td>
<td style="text-align:right;">
0.188716413
</td>
<td style="text-align:right;">
2.013574
</td>
<td style="text-align:right;">
0.6681681
</td>
<td style="text-align:right;">
0.6745093
</td>
<td style="text-align:right;">
6.66037e-05
</td>
<td style="text-align:right;">
4155
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_3mid
</td>
<td style="text-align:right;">
0.399471088
</td>
<td style="text-align:right;">
0.011412604
</td>
<td style="text-align:right;">
35.002625
</td>
<td style="text-align:right;">
145.52828
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.3769152269
</td>
<td style="text-align:right;">
0.422026949
</td>
<td style="text-align:right;">
1.256563
</td>
<td style="text-align:right;">
0.5568481
</td>
<td style="text-align:right;">
0.5628154
</td>
<td style="text-align:right;">
7.11060e-05
</td>
<td style="text-align:right;">
4155
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. local status "pp pv pm vp vv vm mp mv mm"
. foreach x of local status {
  2.     local s = "`x'"
  3.         display "`s'"
  4.         mi estimate: mean `s'_pred [aw = pondera]
  5. }
--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
     pp_pred |   .0031834   .0018764      -.000556    .0069228
     pv_pred |    .021069   .0051113      .0108702    .0312679
     pm_pred |    .013335   .0031729      .0070374    .0196326
     vp_pred |   .0268082   .0049019      .0170584     .036558
     vv_pred |    .185902   .0101749      .1657335    .2060706
     vm_pred |    .148189   .0101427      .1280426    .1683355
     mp_pred |   .0219964   .0044359      .0131741    .0308186
     mv_pred |   .2052371   .0108327      .1837517    .2267225
     mm_pred |   .3742799   .0114412      .3516591    .3969007
--------------------------------------------------------------</code></pre>
</div>
</div>
</div>
<div id="peru-example" class="section level2">
<h2 class="hasAnchor">
<a href="#peru-example" class="anchor"></a>Peru example</h2>
<p>Loading data</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">peru_period0 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span>(<span class="st">"DATA LOCATION 0.dta"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/zap_labels.html">zap_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pondera =</span> pondera <span class="op">*</span><span class="st"> </span>miembros)</a>
<a class="sourceLine" id="cb36-5" title="5">peru_period1 &lt;-</a>
<a class="sourceLine" id="cb36-6" title="6"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span>(<span class="st">"DATA LOCATION 1.dta"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/zap_labels.html">zap_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pondera =</span> pondera <span class="op">*</span><span class="st"> </span>miembros)</a></code></pre></div>
<p>Initializing analysis:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">dependent_var &lt;-<span class="st"> "lipcf"</span></a>
<a class="sourceLine" id="cb37-2" title="2">independent_vars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"hombre"</span>, <span class="st">"edad"</span>, <span class="st">"aedu"</span>, </a>
<a class="sourceLine" id="cb37-4" title="4">   <span class="st">"region1"</span>, <span class="st">"region2"</span>, <span class="st">"region3"</span>, <span class="st">"region4"</span>, <span class="st">"region5"</span>, <span class="st">"region6"</span>, <span class="st">"region7"</span>, </a>
<a class="sourceLine" id="cb37-5" title="5">   <span class="st">"edad2"</span>, <span class="st">"miembros2"</span>, </a>
<a class="sourceLine" id="cb37-6" title="6">   <span class="st">"edad_region"</span>, <span class="st">"edad2_region"</span>, <span class="st">"hombre_region"</span>, <span class="st">"aedu_region"</span>, </a>
<a class="sourceLine" id="cb37-7" title="7">   <span class="st">"miembros_region"</span>, <span class="st">"miembros2_region"</span>, </a>
<a class="sourceLine" id="cb37-8" title="8">   <span class="st">"edad_region1"</span>, <span class="st">"edad2_region1"</span>, <span class="st">"hombre_region1"</span>, <span class="st">"aedu_region1"</span>, </a>
<a class="sourceLine" id="cb37-9" title="9">   <span class="st">"miembros_region1"</span>, <span class="st">"miembros2_region1"</span>, </a>
<a class="sourceLine" id="cb37-10" title="10">   <span class="st">"edad_region2"</span>, <span class="st">"edad2_region2"</span>, <span class="st">"hombre_region2"</span>, <span class="st">"aedu_region2"</span>, </a>
<a class="sourceLine" id="cb37-11" title="11">   <span class="st">"miembros_region2"</span>, <span class="st">"miembros2_region2"</span>, </a>
<a class="sourceLine" id="cb37-12" title="12">   <span class="st">"edad_region3"</span>, <span class="st">"edad2_region3"</span>, <span class="st">"hombre_region3"</span>, <span class="st">"aedu_region3"</span>, </a>
<a class="sourceLine" id="cb37-13" title="13">   <span class="st">"miembros_region3"</span>, <span class="st">"miembros2_region3"</span>, </a>
<a class="sourceLine" id="cb37-14" title="14">   <span class="st">"edad_region4"</span>, <span class="st">"edad2_region4"</span>, <span class="st">"hombre_region4"</span>, <span class="st">"aedu_region4"</span>, </a>
<a class="sourceLine" id="cb37-15" title="15">   <span class="st">"miembros_region4"</span>, <span class="st">"miembros2_region4"</span>, </a>
<a class="sourceLine" id="cb37-16" title="16">   <span class="st">"edad_region5"</span>, <span class="st">"edad2_region5"</span>, <span class="st">"hombre_region5"</span>, <span class="st">"aedu_region5"</span>, </a>
<a class="sourceLine" id="cb37-17" title="17">   <span class="st">"miembros_region5"</span>, <span class="st">"miembros2_region5"</span>, </a>
<a class="sourceLine" id="cb37-18" title="18">   <span class="st">"edad_region6"</span>, <span class="st">"edad2_region6"</span>, <span class="st">"hombre_region6"</span>, <span class="st">"aedu_region6"</span>, </a>
<a class="sourceLine" id="cb37-19" title="19">   <span class="st">"miembros_region6"</span>, <span class="st">"miembros2_region6"</span>, </a>
<a class="sourceLine" id="cb37-20" title="20">   <span class="st">"edad_region7"</span>, <span class="st">"edad2_region7"</span>, <span class="st">"hombre_region7"</span>, <span class="st">"aedu_region7"</span>)</a>
<a class="sourceLine" id="cb37-21" title="21">weight_var &lt;-<span class="st"> "pondera"</span></a>
<a class="sourceLine" id="cb37-22" title="22">n_iterations &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb37-23" title="23">n_nearest &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb37-24" title="24">period0_year &lt;-<span class="st"> </span><span class="dv">2016</span></a>
<a class="sourceLine" id="cb37-25" title="25">period1_year &lt;-<span class="st"> </span><span class="dv">2014</span></a></code></pre></div>
<p>Running the analysis is made in one command:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">2123138</span>)</a>
<a class="sourceLine" id="cb38-2" title="2">peru_mi_data_raw &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb38-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/lassopmm.html">lassopmm</a></span>(peru_period1, </a>
<a class="sourceLine" id="cb38-4" title="4">           peru_period0, </a>
<a class="sourceLine" id="cb38-5" title="5">           <span class="dt">dep_var =</span> dependent_var, </a>
<a class="sourceLine" id="cb38-6" title="6">           <span class="dt">indep_var =</span> independent_vars, </a>
<a class="sourceLine" id="cb38-7" title="7">           <span class="dt">weight_var =</span> weight_var, </a>
<a class="sourceLine" id="cb38-8" title="8">           <span class="dt">n_near =</span> n_nearest, </a>
<a class="sourceLine" id="cb38-9" title="9">           <span class="dt">n_boot =</span> n_iterations)</a></code></pre></div>
<p>Calculating all variable:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">predicted_var_enquo &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(dependent_var, <span class="st">"_source"</span>))</a>
<a class="sourceLine" id="cb39-2" title="2">predicted_var_enquo &lt;-<span class="st"> </span><span class="kw">enquo</span>(predicted_var_enquo)</a>
<a class="sourceLine" id="cb39-3" title="3"></a>
<a class="sourceLine" id="cb39-4" title="4">pred_var_period0_enquo &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"ipcf_"</span>, period0_year))</a>
<a class="sourceLine" id="cb39-5" title="5">pred_var_period0_enquo &lt;-<span class="st"> </span><span class="kw">enquo</span>(pred_var_period0_enquo)</a>
<a class="sourceLine" id="cb39-6" title="6"></a>
<a class="sourceLine" id="cb39-7" title="7">poor_period1_enquo &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"poor_"</span>, period0_year))</a>
<a class="sourceLine" id="cb39-8" title="8">poor_period1_enquo &lt;-<span class="st"> </span><span class="kw">enquo</span>(poor_period1_enquo)</a>
<a class="sourceLine" id="cb39-9" title="9"></a>
<a class="sourceLine" id="cb39-10" title="10">peru_mi_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb39-11" title="11"><span class="st">  </span>peru_mi_data_raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb39-13" title="13">    <span class="dt">ipcf_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(<span class="op">!!</span>predicted_var_enquo),</a>
<a class="sourceLine" id="cb39-14" title="14">    <span class="dt">perc =</span> statar<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/statar/topics/xtile">xtile</a></span>(ipcf, <span class="dt">wt =</span> pondera, <span class="dt">n =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb39-15" title="15">    <span class="dt">g_a =</span> (<span class="op">!!</span>pred_var_period0_enquo<span class="op">/</span>ipcf) <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(period1_year <span class="op">-</span><span class="st"> </span>period0_year)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb39-16" title="16">    <span class="dt">g_p =</span> (ipcf_pred<span class="op">/</span>ipcf) <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(period1_year <span class="op">-</span><span class="st"> </span>period0_year)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb39-17" title="17">    <span class="dt">poor_pred =</span> <span class="kw">if_else</span>(<span class="op">!!</span>predicted_var_enquo <span class="op">&lt;</span><span class="st"> </span>lpl, <span class="dv">1</span>, <span class="dv">0</span>, <span class="ot">NA_real_</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-18" title="18"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb39-19" title="19">    <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb39-20" title="20">      <span class="dt">poor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb39-21" title="21">      <span class="op">!!</span><span class="kw">sym</span>(rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/as_name.html">as_name</a></span>(poor_period1_enquo)) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb39-22" title="22">      <span class="dt">mobility_actual =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb39-23" title="23">    ), </a>
<a class="sourceLine" id="cb39-24" title="24">    <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"poor"</span>, rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/as_name.html">as_name</a></span>(poor_period1_enquo))</a>
<a class="sourceLine" id="cb39-25" title="25">  )<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-26" title="26"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb39-27" title="27">    <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb39-28" title="28">      <span class="dt">poor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb39-29" title="29">      <span class="dt">poor_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb39-30" title="30">      <span class="dt">mobility_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb39-31" title="31">    ), </a>
<a class="sourceLine" id="cb39-32" title="32">    <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"poor"</span>, <span class="st">"poor_pred"</span>)</a>
<a class="sourceLine" id="cb39-33" title="33">  )</a></code></pre></div>
<div id="mi-estimate-mean-g_a-g_p-aw-ponderaoverperc-1" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_a-g_p-aw-ponderaoverperc-1" class="anchor"></a><code>mi estimate: mean g_a g_p [aw = pondera],over(perc)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb40-2" title="2">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(peru_mi_data, <span class="st">"g_a"</span>, <span class="st">"perc"</span>, <span class="st">"pondera"</span>),</a>
<a class="sourceLine" id="cb40-3" title="3">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(peru_mi_data, <span class="st">"g_p"</span>, <span class="st">"perc"</span>, <span class="st">"pondera"</span>)</a>
<a class="sourceLine" id="cb40-4" title="4">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
perc
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.351785258
</td>
<td style="text-align:right;">
0.03365823
</td>
<td style="text-align:right;">
10.451687
</td>
<td style="text-align:right;">
236.00128
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.285476299
</td>
<td style="text-align:right;">
0.41809422
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.008368156
</td>
<td style="text-align:right;">
0.0011328764
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0011328764
</td>
<td style="text-align:right;">
238
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.210393128
</td>
<td style="text-align:right;">
0.03127036
</td>
<td style="text-align:right;">
6.728196
</td>
<td style="text-align:right;">
211.00667
</td>
<td style="text-align:right;">
0.0000000002
</td>
<td style="text-align:right;">
0.148750791
</td>
<td style="text-align:right;">
0.27203547
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.009345503
</td>
<td style="text-align:right;">
0.0009778356
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0009778356
</td>
<td style="text-align:right;">
213
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.102079907
</td>
<td style="text-align:right;">
0.02445507
</td>
<td style="text-align:right;">
4.174181
</td>
<td style="text-align:right;">
233.00190
</td>
<td style="text-align:right;">
0.0000422558
</td>
<td style="text-align:right;">
0.053898583
</td>
<td style="text-align:right;">
0.15026123
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.008474508
</td>
<td style="text-align:right;">
0.0005980506
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0005980506
</td>
<td style="text-align:right;">
235
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.024212491
</td>
<td style="text-align:right;">
0.01610680
</td>
<td style="text-align:right;">
1.503246
</td>
<td style="text-align:right;">
212.00644
</td>
<td style="text-align:right;">
0.1342636535
</td>
<td style="text-align:right;">
-0.007537505
</td>
<td style="text-align:right;">
0.05596249
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.009302047
</td>
<td style="text-align:right;">
0.0002594291
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0002594291
</td>
<td style="text-align:right;">
214
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.060095997
</td>
<td style="text-align:right;">
0.01521399
</td>
<td style="text-align:right;">
-3.950047
</td>
<td style="text-align:right;">
213.00621
</td>
<td style="text-align:right;">
0.0001062216
</td>
<td style="text-align:right;">
-0.090085270
</td>
<td style="text-align:right;">
-0.03010673
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.009258993
</td>
<td style="text-align:right;">
0.0002314656
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0002314656
</td>
<td style="text-align:right;">
215
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.623840487
</td>
<td style="text-align:right;">
0.07455084
</td>
<td style="text-align:right;">
8.367987
</td>
<td style="text-align:right;">
44.42163
</td>
<td style="text-align:right;">
0.0000000001
</td>
<td style="text-align:right;">
0.473633403
</td>
<td style="text-align:right;">
0.77404757
</td>
<td style="text-align:right;">
2.101702
</td>
<td style="text-align:right;">
0.6775963
</td>
<td style="text-align:right;">
0.691193664
</td>
<td style="text-align:right;">
0.0017918642
</td>
<td style="text-align:right;">
0.0036921217
</td>
<td style="text-align:right;">
0.0055578283
</td>
<td style="text-align:right;">
238
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.269826818
</td>
<td style="text-align:right;">
0.04929942
</td>
<td style="text-align:right;">
5.473225
</td>
<td style="text-align:right;">
53.67845
</td>
<td style="text-align:right;">
0.0000011914
</td>
<td style="text-align:right;">
0.170973865
</td>
<td style="text-align:right;">
0.36867977
</td>
<td style="text-align:right;">
1.435331
</td>
<td style="text-align:right;">
0.5893782
</td>
<td style="text-align:right;">
0.603867745
</td>
<td style="text-align:right;">
0.0009979887
</td>
<td style="text-align:right;">
0.0014043572
</td>
<td style="text-align:right;">
0.0024304331
</td>
<td style="text-align:right;">
213
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.129419725
</td>
<td style="text-align:right;">
0.03976012
</td>
<td style="text-align:right;">
3.255013
</td>
<td style="text-align:right;">
58.08108
</td>
<td style="text-align:right;">
0.0018935472
</td>
<td style="text-align:right;">
0.049833560
</td>
<td style="text-align:right;">
0.20900589
</td>
<td style="text-align:right;">
1.396862
</td>
<td style="text-align:right;">
0.5827878
</td>
<td style="text-align:right;">
0.596448743
</td>
<td style="text-align:right;">
0.0006595571
</td>
<td style="text-align:right;">
0.0009032453
</td>
<td style="text-align:right;">
0.0015808673
</td>
<td style="text-align:right;">
235
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.008916171
</td>
<td style="text-align:right;">
0.03667350
</td>
<td style="text-align:right;">
-0.243123
</td>
<td style="text-align:right;">
48.31118
</td>
<td style="text-align:right;">
0.8089394649
</td>
<td style="text-align:right;">
-0.082640919
</td>
<td style="text-align:right;">
0.06480858
</td>
<td style="text-align:right;">
1.684795
</td>
<td style="text-align:right;">
0.6275321
</td>
<td style="text-align:right;">
0.642050119
</td>
<td style="text-align:right;">
0.0005009491
</td>
<td style="text-align:right;">
0.0008274477
</td>
<td style="text-align:right;">
0.0013449457
</td>
<td style="text-align:right;">
214
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.139849305
</td>
<td style="text-align:right;">
0.03505891
</td>
<td style="text-align:right;">
-3.988981
</td>
<td style="text-align:right;">
36.06562
</td>
<td style="text-align:right;">
0.0003106443
</td>
<td style="text-align:right;">
-0.210947570
</td>
<td style="text-align:right;">
-0.06875104
</td>
<td style="text-align:right;">
2.626312
</td>
<td style="text-align:right;">
0.7242377
</td>
<td style="text-align:right;">
0.738355618
</td>
<td style="text-align:right;">
0.0003389468
</td>
<td style="text-align:right;">
0.0008727256
</td>
<td style="text-align:right;">
0.0012291269
</td>
<td style="text-align:right;">
215
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. mi estimate: mean g_a g_p [aw = pondera],over(perc)
(system variable _mi_id updated due to changed number of obs.)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      1,120
                                  Average RVI     =     0.9300
                                  Largest FMI     =     0.7596
                                  Complete DF     =       1119
DF adjustment:   Small sample     DF:     min     =      65.83
                                          avg     =     609.14
Within VCE type:     Analytic             max     =   1,117.01

            1: perc = 1
            2: perc = 2
            3: perc = 3
            4: perc = 4
            5: perc = 5

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
g_a          |
           1 |   .3517853   .0336582      .2857448    .4178257
           2 |   .2103931   .0312704      .1490379    .2717484
           3 |   .1020799   .0244551      .0540969     .150063
           4 |   .0242125   .0161068     -.0073905    .0558155
           5 |   -.060096    .015214     -.0899472   -.0302448
-------------+------------------------------------------------
g_p          |
           1 |   .6254801   .0631091      .5006949    .7502653
           2 |   .2696661   .0536662      .1630107    .3763215
           3 |   .1272477   .0411645      .0456221    .2088734
           4 |  -.0157978    .034403     -.0839752    .0523797
           5 |   -.140624   .0372139     -.2149275   -.0663206
--------------------------------------------------------------</code></pre>
</div>
<div id="mi-estimate-mean-g_a-aw-ponderaovermobility_actual-1" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_a-aw-ponderaovermobility_actual-1" class="anchor"></a><code>mi estimate: mean g_a [aw = pondera],over(mobility_actual)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(peru_mi_data, <span class="st">"g_a"</span>, <span class="st">"mobility_actual"</span>, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb42-2" title="2"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_actual
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.03302611
</td>
<td style="text-align:right;">
0.01901060
</td>
<td style="text-align:right;">
1.737247
</td>
<td style="text-align:right;">
165.0188
</td>
<td style="text-align:right;">
0.08420937
</td>
<td style="text-align:right;">
-0.004509252
</td>
<td style="text-align:right;">
0.07056146
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.011903431
</td>
<td style="text-align:right;">
0.0003614028
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0003614028
</td>
<td style="text-align:right;">
167
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.29658480
</td>
<td style="text-align:right;">
0.01431003
</td>
<td style="text-align:right;">
-20.725658
</td>
<td style="text-align:right;">
96.0498
</td>
<td style="text-align:right;">
0.00000000
</td>
<td style="text-align:right;">
-0.324989795
</td>
<td style="text-align:right;">
-0.26817980
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.020191864
</td>
<td style="text-align:right;">
0.0002047770
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0002047770
</td>
<td style="text-align:right;">
98
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.69804862
</td>
<td style="text-align:right;">
0.04909004
</td>
<td style="text-align:right;">
14.219762
</td>
<td style="text-align:right;">
124.0341
</td>
<td style="text-align:right;">
0.00000000
</td>
<td style="text-align:right;">
0.600885951
</td>
<td style="text-align:right;">
0.79521128
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.015743804
</td>
<td style="text-align:right;">
0.0024098315
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0024098315
</td>
<td style="text-align:right;">
126
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.09919072
</td>
<td style="text-align:right;">
0.01182147
</td>
<td style="text-align:right;">
8.390726
</td>
<td style="text-align:right;">
722.9358
</td>
<td style="text-align:right;">
0.00000000
</td>
<td style="text-align:right;">
0.075982205
</td>
<td style="text-align:right;">
0.12239923
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002755064
</td>
<td style="text-align:right;">
0.0001397471
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0001397471
</td>
<td style="text-align:right;">
725
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. mi estimate: mean g_a [aw = pondera],over(mobility_actual)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      1,120
                                  Average RVI     =     0.0000
                                  Largest FMI     =     0.0000
                                  Complete DF     =       1119
DF adjustment:   Small sample     DF:     min     =   1,117.01
                                          avg     =   1,117.01
Within VCE type:     Analytic             max     =   1,117.01

            1: mobility_actual = 1
            2: mobility_actual = 2
            3: mobility_actual = 3
            4: mobility_actual = 4

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
           1 |   .0330261   .0190106     -.0042744    .0703266
           2 |  -.2965848     .01431     -.3246624   -.2685072
           3 |   .6980486     .04909      .6017295    .7943677
           4 |   .0991907   .0118215      .0759959    .1223855
--------------------------------------------------------------</code></pre>
</div>
<div id="mi-estimate-mean-g_p-aw-ponderaovermobility_pred-1" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_p-aw-ponderaovermobility_pred-1" class="anchor"></a><code>mi estimate: mean g_p [aw = pondera],over(mobility_pred)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb44-2" title="2">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(peru_mi_data, <span class="st">"g_p"</span>, <span class="st">"mobility_pred"</span>, <span class="st">"pondera"</span>, <span class="dt">use_random =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb44-3" title="3">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(peru_mi_data, <span class="st">"g_p"</span>, <span class="st">"mobility_pred"</span>, <span class="st">"pondera"</span>, <span class="dt">use_random =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb44-4" title="4">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb44-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.07582656
</td>
<td style="text-align:right;">
0.03569274
</td>
<td style="text-align:right;">
2.124425
</td>
<td style="text-align:right;">
42.64596
</td>
<td style="text-align:right;">
0.0394726990
</td>
<td style="text-align:right;">
0.003828001
</td>
<td style="text-align:right;">
0.1478251
</td>
<td style="text-align:right;">
1.023956
</td>
<td style="text-align:right;">
0.5059182
</td>
<td style="text-align:right;">
0.5275666
</td>
<td style="text-align:right;">
0.0006294463
</td>
<td style="text-align:right;">
0.0006318878
</td>
<td style="text-align:right;">
0.0012739719
</td>
<td style="text-align:right;">
113
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.35766642
</td>
<td style="text-align:right;">
0.02162371
</td>
<td style="text-align:right;">
-16.540471
</td>
<td style="text-align:right;">
32.30346
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
-0.401696256
</td>
<td style="text-align:right;">
-0.3136366
</td>
<td style="text-align:right;">
1.486049
</td>
<td style="text-align:right;">
0.5977553
</td>
<td style="text-align:right;">
0.6205431
</td>
<td style="text-align:right;">
0.0001880836
</td>
<td style="text-align:right;">
0.0002740210
</td>
<td style="text-align:right;">
0.0004675850
</td>
<td style="text-align:right;">
107
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.81359797
</td>
<td style="text-align:right;">
0.07391614
</td>
<td style="text-align:right;">
11.007041
</td>
<td style="text-align:right;">
41.15175
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.664338017
</td>
<td style="text-align:right;">
0.9628579
</td>
<td style="text-align:right;">
1.386284
</td>
<td style="text-align:right;">
0.5809384
</td>
<td style="text-align:right;">
0.5999212
</td>
<td style="text-align:right;">
0.0022895831
</td>
<td style="text-align:right;">
0.0031117769
</td>
<td style="text-align:right;">
0.0054635956
</td>
<td style="text-align:right;">
139
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.08393061
</td>
<td style="text-align:right;">
0.02372253
</td>
<td style="text-align:right;">
3.538013
</td>
<td style="text-align:right;">
83.52202
</td>
<td style="text-align:right;">
0.0006612825
</td>
<td style="text-align:right;">
0.036751813
</td>
<td style="text-align:right;">
0.1311094
</td>
<td style="text-align:right;">
1.633453
</td>
<td style="text-align:right;">
0.6202703
</td>
<td style="text-align:right;">
0.6290480
</td>
<td style="text-align:right;">
0.0002136961
</td>
<td style="text-align:right;">
0.0003422180
</td>
<td style="text-align:right;">
0.0005627584
</td>
<td style="text-align:right;">
641
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.08163789
</td>
<td style="text-align:right;">
0.04203023
</td>
<td style="text-align:right;">
1.942361
</td>
<td style="text-align:right;">
30.23573
</td>
<td style="text-align:right;">
0.0614586952
</td>
<td style="text-align:right;">
-0.004171245
</td>
<td style="text-align:right;">
0.1674470
</td>
<td style="text-align:right;">
1.753680
</td>
<td style="text-align:right;">
0.6368495
</td>
<td style="text-align:right;">
0.6587026
</td>
<td style="text-align:right;">
0.0006415200
</td>
<td style="text-align:right;">
0.0011029613
</td>
<td style="text-align:right;">
0.0017665406
</td>
<td style="text-align:right;">
113
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.35415263
</td>
<td style="text-align:right;">
0.02323771
</td>
<td style="text-align:right;">
-15.240424
</td>
<td style="text-align:right;">
28.14778
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
-0.401741678
</td>
<td style="text-align:right;">
-0.3065636
</td>
<td style="text-align:right;">
1.834275
</td>
<td style="text-align:right;">
0.6471761
</td>
<td style="text-align:right;">
0.6698310
</td>
<td style="text-align:right;">
0.0001905218
</td>
<td style="text-align:right;">
0.0003426172
</td>
<td style="text-align:right;">
0.0005399914
</td>
<td style="text-align:right;">
107
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.82775431
</td>
<td style="text-align:right;">
0.08927571
</td>
<td style="text-align:right;">
9.271888
</td>
<td style="text-align:right;">
30.38605
</td>
<td style="text-align:right;">
0.0000000002
</td>
<td style="text-align:right;">
0.645526086
</td>
<td style="text-align:right;">
1.0099825
</td>
<td style="text-align:right;">
2.191370
</td>
<td style="text-align:right;">
0.6866549
</td>
<td style="text-align:right;">
0.7054260
</td>
<td style="text-align:right;">
0.0024974077
</td>
<td style="text-align:right;">
0.0053654352
</td>
<td style="text-align:right;">
0.0079701516
</td>
<td style="text-align:right;">
139
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.08730004
</td>
<td style="text-align:right;">
0.02477054
</td>
<td style="text-align:right;">
3.524349
</td>
<td style="text-align:right;">
79.80939
</td>
<td style="text-align:right;">
0.0007061017
</td>
<td style="text-align:right;">
0.038003280
</td>
<td style="text-align:right;">
0.1365968
</td>
<td style="text-align:right;">
1.742380
</td>
<td style="text-align:right;">
0.6353533
</td>
<td style="text-align:right;">
0.6441602
</td>
<td style="text-align:right;">
0.0002237399
</td>
<td style="text-align:right;">
0.0003821960
</td>
<td style="text-align:right;">
0.0006135798
</td>
<td style="text-align:right;">
641
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. mi estimate: mean g_p [aw = pondera],over(mobility_pred)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =      1,120
                                  Average RVI     =     1.9750
                                  Largest FMI     =     0.7310
                                  Complete DF     =       1119
DF adjustment:   Small sample     DF:     min     =      71.71
                                          avg     =      90.32
Within VCE type:     Analytic             max     =     106.53

            1: mobility_pred = 1
            2: mobility_pred = 2
            3: mobility_pred = 3
            4: mobility_pred = 4

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
           1 |   .1001192   .0371871      .0263964    .1738419
           2 |  -.3541853   .0218472       -.39774   -.3106306
           3 |   .9141378   .0803982      .7547496    1.073526
           4 |   .1149986   .0266164      .0619933    .1680039
--------------------------------------------------------------
Note: Numbers of observations in e(_N) vary among imputations.</code></pre>
</div>
<div id="poverty-analysis-1" class="section level3">
<h3 class="hasAnchor">
<a href="#poverty-analysis-1" class="anchor"></a>Poverty analysis</h3>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">pl_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">5.5</span> <span class="op">*</span><span class="st"> </span><span class="fl">30.41667</span></a>
<a class="sourceLine" id="cb46-2" title="2">pl_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="fl">30.41667</span></a>
<a class="sourceLine" id="cb46-3" title="3"></a>
<a class="sourceLine" id="cb46-4" title="4">peru_poverty_calc &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb46-5" title="5"><span class="st">  </span>peru_mi_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ipcf =</span> <span class="kw">if_else</span>(.imp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA_real_</span>, ipcf),</a>
<a class="sourceLine" id="cb46-7" title="7">         <span class="op">!!</span><span class="dt">pred_var_period0_enquo :=</span> <span class="kw">if_else</span>(.imp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA_real_</span>, <span class="op">!!</span>pred_var_period0_enquo)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf, <span class="st">"act"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf_pred, <span class="st">"pred"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-10" title="10"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(<span class="op">!!</span>pred_var_period0_enquo, period0_year, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb46-11" title="11"><span class="st">  </span><span class="kw">select</span>(.id, .imp, pondera, <span class="kw">contains</span>(<span class="st">"ipcf"</span>), </a>
<a class="sourceLine" id="cb46-12" title="12">         <span class="kw">contains</span>(<span class="st">"_act"</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">"_actual"</span>), </a>
<a class="sourceLine" id="cb46-13" title="13">         <span class="kw">contains</span>(<span class="st">"_pred"</span>), <span class="kw">contains</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"_"</span>, period0_year))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-14" title="14"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb46-15" title="15">    (.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-16" title="16"><span class="st">      </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_"</span>, period0_year,<span class="st">"$"</span>)), <span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_act$"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="st">      </span><span class="kw"><a href="../reference/get_all_combinations.html">get_all_combinations</a></span>(mAct)</a>
<a class="sourceLine" id="cb46-18" title="18">  )  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-19" title="19"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb46-20" title="20">    (.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-21" title="21"><span class="st">      </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_"</span>, period0_year,<span class="st">"$"</span>)), <span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_pred$"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb46-22" title="22"><span class="st">      </span><span class="kw"><a href="../reference/get_all_combinations.html">get_all_combinations</a></span>(mPred)</a>
<a class="sourceLine" id="cb46-23" title="23">  )</a></code></pre></div>
<div id="actual-mobility-1" class="section level4">
<h4 class="hasAnchor">
<a href="#actual-mobility-1" class="anchor"></a>Actual mobility</h4>
<p>R:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1">compare_vars &lt;-</a>
<a class="sourceLine" id="cb47-2" title="2"><span class="st">  </span>peru_poverty_calc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb47-4" title="4"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magrittr/topics/aliases">extract</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">"mAct_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>()</a>
<a class="sourceLine" id="cb47-6" title="6"></a>
<a class="sourceLine" id="cb47-7" title="7">peru_act_mob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb47-8" title="8"><span class="st">  </span>peru_poverty_calc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/get_mi_means_table.html">get_mi_means_table</a></span>(compare_vars, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-10" title="10"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ubar, <span class="op">-</span>t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-11" title="11"><span class="st">  </span><span class="kw">arrange</span>(variable) </a>
<a class="sourceLine" id="cb47-12" title="12">peru_act_mob <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb47-13" title="13"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mAct_1poor_1poor
</td>
<td style="text-align:right;">
0.133866296
</td>
<td style="text-align:right;">
0.010179186
</td>
<td style="text-align:right;">
13.150982
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
0.00000e+00
</td>
<td style="text-align:right;">
0.113893814
</td>
<td style="text-align:right;">
0.15383878
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_1poor_2vul
</td>
<td style="text-align:right;">
0.076146889
</td>
<td style="text-align:right;">
0.007928892
</td>
<td style="text-align:right;">
9.603724
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
0.00000e+00
</td>
<td style="text-align:right;">
0.060589688
</td>
<td style="text-align:right;">
0.09170409
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_1poor_3mid
</td>
<td style="text-align:right;">
0.005860557
</td>
<td style="text-align:right;">
0.002281803
</td>
<td style="text-align:right;">
2.568389
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
1.03463e-02
</td>
<td style="text-align:right;">
0.001383455
</td>
<td style="text-align:right;">
0.01033766
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_1poor
</td>
<td style="text-align:right;">
0.093557258
</td>
<td style="text-align:right;">
0.008705503
</td>
<td style="text-align:right;">
10.746910
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
0.00000e+00
</td>
<td style="text-align:right;">
0.076476275
</td>
<td style="text-align:right;">
0.11063824
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_2vul
</td>
<td style="text-align:right;">
0.225904882
</td>
<td style="text-align:right;">
0.012501005
</td>
<td style="text-align:right;">
18.070938
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
0.00000e+00
</td>
<td style="text-align:right;">
0.201376782
</td>
<td style="text-align:right;">
0.25043298
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_3mid
</td>
<td style="text-align:right;">
0.079445306
</td>
<td style="text-align:right;">
0.008084327
</td>
<td style="text-align:right;">
9.827077
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
0.00000e+00
</td>
<td style="text-align:right;">
0.063583127
</td>
<td style="text-align:right;">
0.09530749
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_1poor
</td>
<td style="text-align:right;">
0.019965097
</td>
<td style="text-align:right;">
0.004181590
</td>
<td style="text-align:right;">
4.774523
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
2.04060e-06
</td>
<td style="text-align:right;">
0.011760440
</td>
<td style="text-align:right;">
0.02816975
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_2vul
</td>
<td style="text-align:right;">
0.146535345
</td>
<td style="text-align:right;">
0.010571800
</td>
<td style="text-align:right;">
13.860965
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
0.00000e+00
</td>
<td style="text-align:right;">
0.125792520
</td>
<td style="text-align:right;">
0.16727817
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_3mid
</td>
<td style="text-align:right;">
0.218718370
</td>
<td style="text-align:right;">
0.012357522
</td>
<td style="text-align:right;">
17.699209
</td>
<td style="text-align:right;">
1116.893
</td>
<td style="text-align:right;">
0.00000e+00
</td>
<td style="text-align:right;">
0.194471796
</td>
<td style="text-align:right;">
0.24296494
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.001785884
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
1119
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata (additional statistics is ommited):</p>
<pre><code>. local status "pp pv pm vp vv vm mp mv mm"

. 
. foreach x of local status {
  2.     local s = "`x'"
  3.         display "`s'"
  4.         mi estimate: mean `s'_actual [aw = pondera]
  5. }
--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
   pp_actual |   .1338663   .0101792      .1138938    .1538388
   pv_actual |   .0761469   .0079289      .0605897    .0917041
   pm_actual |   .0058606   .0022818      .0013835    .0103377
   vp_actual |   .0935573   .0087055      .0764763    .1106382
   vv_actual |   .2259049    .012501      .2013768     .250433
   vm_actual |   .0794453   .0080843      .0635831    .0953075
   mp_actual |   .0199651   .0041816      .0117604    .0281698
   mv_actual |   .1465353   .0105718      .1257925    .1672782
   mm_actual |   .2187184   .0123575      .1944718    .2429649
--------------------------------------------------------------
</code></pre>
</div>
<div id="predicted-mobility-1" class="section level4">
<h4 class="hasAnchor">
<a href="#predicted-mobility-1" class="anchor"></a>Predicted mobility</h4>
<p>R:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">compare_vars2 &lt;-</a>
<a class="sourceLine" id="cb49-2" title="2"><span class="st">  </span>peru_poverty_calc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb49-4" title="4"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magrittr/topics/aliases">extract</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">"mPred_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>()</a>
<a class="sourceLine" id="cb49-6" title="6">peru_pred_mob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb49-7" title="7"><span class="st">  </span>peru_poverty_calc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/get_mi_means_table.html">get_mi_means_table</a></span>(compare_vars2, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb49-9" title="9"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ubar, <span class="op">-</span>t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-10" title="10"><span class="st">  </span><span class="kw">arrange</span>(variable) </a>
<a class="sourceLine" id="cb49-11" title="11">peru_pred_mob <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb49-12" title="12"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mPred_1poor_1poor
</td>
<td style="text-align:right;">
0.10076904
</td>
<td style="text-align:right;">
0.013498280
</td>
<td style="text-align:right;">
7.465324
</td>
<td style="text-align:right;">
120.10142
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.07404361
</td>
<td style="text-align:right;">
0.12749446
</td>
<td style="text-align:right;">
1.252451
</td>
<td style="text-align:right;">
0.5560392
</td>
<td style="text-align:right;">
0.5632521
</td>
<td style="text-align:right;">
0.0000993258
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_1poor_2vul
</td>
<td style="text-align:right;">
0.08559530
</td>
<td style="text-align:right;">
0.012769282
</td>
<td style="text-align:right;">
6.703219
</td>
<td style="text-align:right;">
114.21454
</td>
<td style="text-align:right;">
0.0000000008
</td>
<td style="text-align:right;">
0.06029996
</td>
<td style="text-align:right;">
0.11089064
</td>
<td style="text-align:right;">
1.333844
</td>
<td style="text-align:right;">
0.5715223
</td>
<td style="text-align:right;">
0.5788333
</td>
<td style="text-align:right;">
0.0000913621
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_1poor_3mid
</td>
<td style="text-align:right;">
0.02950940
</td>
<td style="text-align:right;">
0.008018248
</td>
<td style="text-align:right;">
3.680281
</td>
<td style="text-align:right;">
103.53244
</td>
<td style="text-align:right;">
0.0003719253
</td>
<td style="text-align:right;">
0.01360807
</td>
<td style="text-align:right;">
0.04541074
</td>
<td style="text-align:right;">
1.515371
</td>
<td style="text-align:right;">
0.6024443
</td>
<td style="text-align:right;">
0.6099078
</td>
<td style="text-align:right;">
0.0000379731
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_1poor
</td>
<td style="text-align:right;">
0.07950800
</td>
<td style="text-align:right;">
0.012558502
</td>
<td style="text-align:right;">
6.331009
</td>
<td style="text-align:right;">
109.11035
</td>
<td style="text-align:right;">
0.0000000056
</td>
<td style="text-align:right;">
0.05461774
</td>
<td style="text-align:right;">
0.10439826
</td>
<td style="text-align:right;">
1.414360
</td>
<td style="text-align:right;">
0.5858116
</td>
<td style="text-align:right;">
0.5932005
</td>
<td style="text-align:right;">
0.0000905802
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_2vul
</td>
<td style="text-align:right;">
0.17690616
</td>
<td style="text-align:right;">
0.020047906
</td>
<td style="text-align:right;">
8.824172
</td>
<td style="text-align:right;">
82.51626
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.13702822
</td>
<td style="text-align:right;">
0.21678409
</td>
<td style="text-align:right;">
2.094254
</td>
<td style="text-align:right;">
0.6768204
</td>
<td style="text-align:right;">
0.6843787
</td>
<td style="text-align:right;">
0.0002666928
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_3mid
</td>
<td style="text-align:right;">
0.14249329
</td>
<td style="text-align:right;">
0.018133992
</td>
<td style="text-align:right;">
7.857800
</td>
<td style="text-align:right;">
84.59239
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.10643555
</td>
<td style="text-align:right;">
0.17855103
</td>
<td style="text-align:right;">
2.016729
</td>
<td style="text-align:right;">
0.6685152
</td>
<td style="text-align:right;">
0.6760840
</td>
<td style="text-align:right;">
0.0002155252
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_1poor
</td>
<td style="text-align:right;">
0.03385585
</td>
<td style="text-align:right;">
0.010844446
</td>
<td style="text-align:right;">
3.121953
</td>
<td style="text-align:right;">
65.98626
</td>
<td style="text-align:right;">
0.0026663254
</td>
<td style="text-align:right;">
0.01220413
</td>
<td style="text-align:right;">
0.05550757
</td>
<td style="text-align:right;">
3.033656
</td>
<td style="text-align:right;">
0.7520860
</td>
<td style="text-align:right;">
0.7592733
</td>
<td style="text-align:right;">
0.0000867126
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_2vul
</td>
<td style="text-align:right;">
0.14270982
</td>
<td style="text-align:right;">
0.018625176
</td>
<td style="text-align:right;">
7.662200
</td>
<td style="text-align:right;">
80.42845
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.10564757
</td>
<td style="text-align:right;">
0.17977207
</td>
<td style="text-align:right;">
2.178783
</td>
<td style="text-align:right;">
0.6854142
</td>
<td style="text-align:right;">
0.6929556
</td>
<td style="text-align:right;">
0.0002331061
</td>
<td style="text-align:right;">
1119
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_3mid
</td>
<td style="text-align:right;">
0.20865313
</td>
<td style="text-align:right;">
0.019396093
</td>
<td style="text-align:right;">
10.757482
</td>
<td style="text-align:right;">
101.65559
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.17017951
</td>
<td style="text-align:right;">
0.24712676
</td>
<td style="text-align:right;">
1.552969
</td>
<td style="text-align:right;">
0.6082992
</td>
<td style="text-align:right;">
0.6157847
</td>
<td style="text-align:right;">
0.0002243601
</td>
<td style="text-align:right;">
1119
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. local status "pp pv pm vp vv vm mp mv mm"

. foreach x of local status {
  2.     local s = "`x'"
  3.         display "`s'"
  4.         mi estimate: mean `s'_pred [aw = pondera]
  5. }
--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
     pp_pred |   .1045939   .0124262      .0800627    .1291251
     pv_pred |     .09075   .0158537      .0591705    .1223295
     pm_pred |   .0241286   .0083927      .0074151     .040842
     vp_pred |   .0967613   .0139855      .0690274    .1244952
     vv_pred |    .196144   .0221239      .1520628    .2402252
     vm_pred |   .1094223   .0152451      .0791622    .1396824
     mp_pred |   .0460334   .0100943      .0260052    .0660617
     mv_pred |   .1616931   .0204864       .120876    .2025103
     mm_pred |   .1704734   .0172201      .1363579    .2045889
--------------------------------------------------------------</code></pre>
</div>
</div>
</div>
<div id="nicaragua-example" class="section level2">
<h2 class="hasAnchor">
<a href="#nicaragua-example" class="anchor"></a>Nicaragua example</h2>
<p>Loading data</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">nicaragua_period0 &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span>(<span class="st">"DATA LOCATION 0.dta"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb51-3" title="3"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/zap_labels.html">zap_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pondera =</span> pondera <span class="op">*</span><span class="st"> </span>miembros)</a>
<a class="sourceLine" id="cb51-5" title="5">nicaragua_period1 &lt;-</a>
<a class="sourceLine" id="cb51-6" title="6"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/read_dta.html">read_dta</a></span>(<span class="st">"DATA LOCATION 1.dta"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-7" title="7"><span class="st">  </span>haven<span class="op">::</span><span class="kw"><a href="https://haven.tidyverse.org/reference/zap_labels.html">zap_labels</a></span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb51-8" title="8"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">pondera =</span> pondera <span class="op">*</span><span class="st"> </span>miembros)</a></code></pre></div>
<p>Initializing analysis:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">dependent_var &lt;-<span class="st"> "lipcf"</span></a>
<a class="sourceLine" id="cb52-2" title="2">independent_vars &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb52-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"hombre"</span>, <span class="st">"aedu"</span>, <span class="st">"miembros"</span>, <span class="st">"miembros2"</span>, <span class="st">"urbano"</span>, </a>
<a class="sourceLine" id="cb52-4" title="4">    <span class="st">"region1"</span>, <span class="st">"region2"</span>, <span class="st">"region3"</span>, <span class="st">"region4"</span>, </a>
<a class="sourceLine" id="cb52-5" title="5">    <span class="st">"hombre_region"</span>, <span class="st">"hombre_region1"</span>, <span class="st">"hombre_region2"</span>, </a>
<a class="sourceLine" id="cb52-6" title="6">    <span class="st">"hombre_region3"</span>, <span class="st">"hombre_region4"</span>, </a>
<a class="sourceLine" id="cb52-7" title="7">    <span class="st">"aedu_region"</span>, <span class="st">"aedu_region1"</span>, <span class="st">"aedu_region2"</span>, </a>
<a class="sourceLine" id="cb52-8" title="8">    <span class="st">"aedu_region3"</span>, <span class="st">"aedu_region4"</span>, </a>
<a class="sourceLine" id="cb52-9" title="9">    <span class="st">"miembros_region"</span>, <span class="st">"miembros_region1"</span>, <span class="st">"miembros_region"</span>, </a>
<a class="sourceLine" id="cb52-10" title="10">    <span class="st">"miembros_region3"</span>, <span class="st">"miembros_region4"</span>, </a>
<a class="sourceLine" id="cb52-11" title="11">    <span class="st">"miembros2_region"</span>, <span class="st">"miembros2_region1"</span>, <span class="st">"miembros2_region2"</span>, </a>
<a class="sourceLine" id="cb52-12" title="12">    <span class="st">"miembros2_region3"</span>, <span class="st">"miembros2_region4"</span>, </a>
<a class="sourceLine" id="cb52-13" title="13">    <span class="st">"urbano_region"</span>, <span class="st">"urbano_region1"</span>, <span class="st">"urbano_region2"</span>, </a>
<a class="sourceLine" id="cb52-14" title="14">    <span class="st">"urbano_region3"</span>, <span class="st">"urbano_region4"</span>, </a>
<a class="sourceLine" id="cb52-15" title="15">    <span class="st">"edad"</span>, <span class="st">"edad2"</span>, </a>
<a class="sourceLine" id="cb52-16" title="16">    <span class="st">"edad_region"</span>, <span class="st">"edad_region1"</span>, <span class="st">"edad_region2"</span>, </a>
<a class="sourceLine" id="cb52-17" title="17">    <span class="st">"edad_region3"</span>, <span class="st">"edad_region4"</span>, </a>
<a class="sourceLine" id="cb52-18" title="18">    <span class="st">"edad2_region"</span>, <span class="st">"edad2_region1"</span>, <span class="st">"edad2_region2"</span>, </a>
<a class="sourceLine" id="cb52-19" title="19">    <span class="st">"edad2_region3"</span>, <span class="st">"edad2_region4"</span>)</a>
<a class="sourceLine" id="cb52-20" title="20">weight_var &lt;-<span class="st"> "pondera"</span></a>
<a class="sourceLine" id="cb52-21" title="21">n_iterations &lt;-<span class="st"> </span><span class="dv">50</span></a>
<a class="sourceLine" id="cb52-22" title="22">n_nearest &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb52-23" title="23">period0_year &lt;-<span class="st"> </span><span class="dv">2005</span></a>
<a class="sourceLine" id="cb52-24" title="24">period1_year &lt;-<span class="st"> </span><span class="dv">2001</span></a></code></pre></div>
<p>Running the analysis is made in one command:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">3138</span>)</a>
<a class="sourceLine" id="cb53-2" title="2">nicaragua_mi_data_raw &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="st">  </span><span class="kw"><a href="../reference/lassopmm.html">lassopmm</a></span>(nicaragua_period1, </a>
<a class="sourceLine" id="cb53-4" title="4">           nicaragua_period0, </a>
<a class="sourceLine" id="cb53-5" title="5">           <span class="dt">dep_var =</span> dependent_var, </a>
<a class="sourceLine" id="cb53-6" title="6">           <span class="dt">indep_var =</span> independent_vars, </a>
<a class="sourceLine" id="cb53-7" title="7">           <span class="dt">weight_var =</span> weight_var, </a>
<a class="sourceLine" id="cb53-8" title="8">           <span class="dt">n_near =</span> n_nearest, </a>
<a class="sourceLine" id="cb53-9" title="9">           <span class="dt">n_boot =</span> n_iterations)</a></code></pre></div>
<p>Calculating all variable:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">predicted_var_enquo &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(dependent_var, <span class="st">"_source"</span>))</a>
<a class="sourceLine" id="cb54-2" title="2">predicted_var_enquo &lt;-<span class="st"> </span><span class="kw">enquo</span>(predicted_var_enquo)</a>
<a class="sourceLine" id="cb54-3" title="3"></a>
<a class="sourceLine" id="cb54-4" title="4">pred_var_period0_enquo &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"ipcf_"</span>, period0_year))</a>
<a class="sourceLine" id="cb54-5" title="5">pred_var_period0_enquo &lt;-<span class="st"> </span><span class="kw">enquo</span>(pred_var_period0_enquo)</a>
<a class="sourceLine" id="cb54-6" title="6"></a>
<a class="sourceLine" id="cb54-7" title="7">poor_period1_enquo &lt;-<span class="st"> </span>rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/sym.html">sym</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"poor_"</span>, period0_year))</a>
<a class="sourceLine" id="cb54-8" title="8">poor_period1_enquo &lt;-<span class="st"> </span><span class="kw">enquo</span>(poor_period1_enquo)</a>
<a class="sourceLine" id="cb54-9" title="9"></a>
<a class="sourceLine" id="cb54-10" title="10">nicaragua_mi_data &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb54-11" title="11"><span class="st">  </span>nicaragua_mi_data_raw <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-12" title="12"><span class="st">  </span><span class="kw">mutate</span>(</a>
<a class="sourceLine" id="cb54-13" title="13">    <span class="dt">ipcf_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">exp</a></span>(<span class="op">!!</span>predicted_var_enquo),</a>
<a class="sourceLine" id="cb54-14" title="14">    <span class="dt">perc =</span> statar<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/statar/topics/xtile">xtile</a></span>(ipcf, <span class="dt">wt =</span> pondera, <span class="dt">n =</span> <span class="dv">5</span>),</a>
<a class="sourceLine" id="cb54-15" title="15">    <span class="dt">g_a =</span> (<span class="op">!!</span>pred_var_period0_enquo<span class="op">/</span>ipcf) <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(period1_year <span class="op">-</span><span class="st"> </span>period0_year)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb54-16" title="16">    <span class="dt">g_p =</span> (ipcf_pred<span class="op">/</span>ipcf) <span class="op">^</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(period1_year <span class="op">-</span><span class="st"> </span>period0_year)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>,</a>
<a class="sourceLine" id="cb54-17" title="17">    <span class="dt">poor_pred =</span> <span class="kw">if_else</span>(<span class="op">!!</span>predicted_var_enquo <span class="op">&lt;</span><span class="st"> </span>lpl, <span class="dv">1</span>, <span class="dv">0</span>, <span class="ot">NA_real_</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-18" title="18"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb54-19" title="19">    <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb54-20" title="20">      <span class="dt">poor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb54-21" title="21">      <span class="op">!!</span><span class="kw">sym</span>(rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/as_name.html">as_name</a></span>(poor_period1_enquo)) <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb54-22" title="22">      <span class="dt">mobility_actual =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb54-23" title="23">    ), </a>
<a class="sourceLine" id="cb54-24" title="24">    <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"poor"</span>, rlang<span class="op">::</span><span class="kw"><a href="https://rlang.r-lib.org/reference/as_name.html">as_name</a></span>(poor_period1_enquo))</a>
<a class="sourceLine" id="cb54-25" title="25">  )<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-26" title="26"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb54-27" title="27">    <span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb54-28" title="28">      <span class="dt">poor =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb54-29" title="29">      <span class="dt">poor_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb54-30" title="30">      <span class="dt">mobility_pred =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb54-31" title="31">    ), </a>
<a class="sourceLine" id="cb54-32" title="32">    <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"poor"</span>, <span class="st">"poor_pred"</span>)</a>
<a class="sourceLine" id="cb54-33" title="33">  )</a></code></pre></div>
<div id="mi-estimate-mean-g_a-g_p-aw-ponderaoverperc-2" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_a-g_p-aw-ponderaoverperc-2" class="anchor"></a><code>mi estimate: mean g_a g_p [aw = pondera],over(perc)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb55-2" title="2">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(nicaragua_mi_data, <span class="st">"g_a"</span>, <span class="st">"perc"</span>, <span class="st">"pondera"</span>),</a>
<a class="sourceLine" id="cb55-3" title="3">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(nicaragua_mi_data, <span class="st">"g_p"</span>, <span class="st">"perc"</span>, <span class="st">"pondera"</span>)</a>
<a class="sourceLine" id="cb55-4" title="4">) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb55-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
perc
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.29155718
</td>
<td style="text-align:right;">
0.01881190
</td>
<td style="text-align:right;">
15.4985473
</td>
<td style="text-align:right;">
162.01972
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.25440905
</td>
<td style="text-align:right;">
0.328705313
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.012119764
</td>
<td style="text-align:right;">
0.0003538877
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0003538877
</td>
<td style="text-align:right;">
164
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.12552678
</td>
<td style="text-align:right;">
0.01393311
</td>
<td style="text-align:right;">
9.0092427
</td>
<td style="text-align:right;">
156.02166
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.09800491
</td>
<td style="text-align:right;">
0.153048654
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.012576903
</td>
<td style="text-align:right;">
0.0001941316
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0001941316
</td>
<td style="text-align:right;">
158
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.06151163
</td>
<td style="text-align:right;">
0.01433189
</td>
<td style="text-align:right;">
4.2919418
</td>
<td style="text-align:right;">
180.01442
</td>
<td style="text-align:right;">
0.0000288860
</td>
<td style="text-align:right;">
0.03323152
</td>
<td style="text-align:right;">
0.089791736
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.010928100
</td>
<td style="text-align:right;">
0.0002054030
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0002054030
</td>
<td style="text-align:right;">
182
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.03796299
</td>
<td style="text-align:right;">
0.01414663
</td>
<td style="text-align:right;">
2.6835367
</td>
<td style="text-align:right;">
180.01442
</td>
<td style="text-align:right;">
0.0079640760
</td>
<td style="text-align:right;">
0.01004845
</td>
<td style="text-align:right;">
0.065877538
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.010928100
</td>
<td style="text-align:right;">
0.0002001271
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0002001271
</td>
<td style="text-align:right;">
182
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.02525818
</td>
<td style="text-align:right;">
0.01489748
</td>
<td style="text-align:right;">
-1.6954661
</td>
<td style="text-align:right;">
214.00599
</td>
<td style="text-align:right;">
0.0914413729
</td>
<td style="text-align:right;">
-0.05462277
</td>
<td style="text-align:right;">
0.004106414
</td>
<td style="text-align:right;">
0.000000
</td>
<td style="text-align:right;">
0.0000000
</td>
<td style="text-align:right;">
0.009216336
</td>
<td style="text-align:right;">
0.0002219350
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.0002219350
</td>
<td style="text-align:right;">
216
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.35346736
</td>
<td style="text-align:right;">
0.03390523
</td>
<td style="text-align:right;">
10.4251560
</td>
<td style="text-align:right;">
41.75527
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.28503195
</td>
<td style="text-align:right;">
0.421902780
</td>
<td style="text-align:right;">
1.617702
</td>
<td style="text-align:right;">
0.6179855
</td>
<td style="text-align:right;">
0.635056756
</td>
<td style="text-align:right;">
0.0004391505
</td>
<td style="text-align:right;">
0.0006964848
</td>
<td style="text-align:right;">
0.0011495649
</td>
<td style="text-align:right;">
164
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.15900669
</td>
<td style="text-align:right;">
0.02936949
</td>
<td style="text-align:right;">
5.4140101
</td>
<td style="text-align:right;">
35.32156
</td>
<td style="text-align:right;">
0.0000044567
</td>
<td style="text-align:right;">
0.09940286
</td>
<td style="text-align:right;">
0.218610523
</td>
<td style="text-align:right;">
2.001575
</td>
<td style="text-align:right;">
0.6668415
</td>
<td style="text-align:right;">
0.684229056
</td>
<td style="text-align:right;">
0.0002873714
</td>
<td style="text-align:right;">
0.0005639170
</td>
<td style="text-align:right;">
0.0008625667
</td>
<td style="text-align:right;">
158
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.08933263
</td>
<td style="text-align:right;">
0.02445912
</td>
<td style="text-align:right;">
3.6523242
</td>
<td style="text-align:right;">
47.39159
</td>
<td style="text-align:right;">
0.0006479796
</td>
<td style="text-align:right;">
0.04013796
</td>
<td style="text-align:right;">
0.138527300
</td>
<td style="text-align:right;">
1.486031
</td>
<td style="text-align:right;">
0.5977523
</td>
<td style="text-align:right;">
0.613717206
</td>
<td style="text-align:right;">
0.0002406441
</td>
<td style="text-align:right;">
0.0003505926
</td>
<td style="text-align:right;">
0.0005982485
</td>
<td style="text-align:right;">
182
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.01344080
</td>
<td style="text-align:right;">
0.02260852
</td>
<td style="text-align:right;">
0.5945015
</td>
<td style="text-align:right;">
51.05182
</td>
<td style="text-align:right;">
0.5548024649
</td>
<td style="text-align:right;">
-0.03194658
</td>
<td style="text-align:right;">
0.058828178
</td>
<td style="text-align:right;">
1.329617
</td>
<td style="text-align:right;">
0.5707449
</td>
<td style="text-align:right;">
0.586628039
</td>
<td style="text-align:right;">
0.0002194117
</td>
<td style="text-align:right;">
0.0002860133
</td>
<td style="text-align:right;">
0.0005111452
</td>
<td style="text-align:right;">
182
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.11397242
</td>
<td style="text-align:right;">
0.02434534
</td>
<td style="text-align:right;">
-4.6814873
</td>
<td style="text-align:right;">
39.93092
</td>
<td style="text-align:right;">
0.0000325802
</td>
<td style="text-align:right;">
-0.16317884
</td>
<td style="text-align:right;">
-0.064765990
</td>
<td style="text-align:right;">
2.260468
</td>
<td style="text-align:right;">
0.6932956
</td>
<td style="text-align:right;">
0.707583882
</td>
<td style="text-align:right;">
0.0001817824
</td>
<td style="text-align:right;">
0.0004028562
</td>
<td style="text-align:right;">
0.0005926958
</td>
<td style="text-align:right;">
216
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. mi estimate: mean g_a g_p [aw = pondera],over(perc)
(system variable _mi_id updated due to changed number of obs.)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =        907
                                  Average RVI     =     0.9194
                                  Largest FMI     =     0.7430
                                  Complete DF     =        906
DF adjustment:   Small sample     DF:     min     =      65.62
                                          avg     =     501.82
Within VCE type:     Analytic             max     =     904.01

            1: perc = 1
            2: perc = 2
            3: perc = 3
            4: perc = 4
            5: perc = 5

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
g_a          |
           1 |   .2915572   .0188119      .2546371    .3284773
           2 |   .1255268   .0139331      .0981818    .1528718
           3 |   .0615116   .0143319       .033384    .0896393
           4 |    .037963   .0141466      .0101989     .065727
           5 |  -.0252582   .0148975     -.0544959    .0039795
-------------+------------------------------------------------
g_p          |
           1 |   .3565944   .0292254      .2988223    .4143665
           2 |   .1620549   .0310642      .1001321    .2239776
           3 |   .0887222    .030527      .0277665    .1496779
           4 |   .0124655   .0223407     -.0317631    .0566942
           5 |  -.1098526   .0221231     -.1537613   -.0659439
--------------------------------------------------------------</code></pre>
</div>
<div id="mi-estimate-mean-g_a-aw-ponderaovermobility_actual-2" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_a-aw-ponderaovermobility_actual-2" class="anchor"></a><code>mi estimate: mean g_a [aw = pondera],over(mobility_actual)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(nicaragua_mi_data, <span class="st">"g_a"</span>, <span class="st">"mobility_actual"</span>, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb57-2" title="2"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_actual
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.07798521
</td>
<td style="text-align:right;">
0.01046177
</td>
<td style="text-align:right;">
7.454303
</td>
<td style="text-align:right;">
345.98247
</td>
<td style="text-align:right;">
0.000e+00
</td>
<td style="text-align:right;">
0.05740854
</td>
<td style="text-align:right;">
0.09856188
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.005730947
</td>
<td style="text-align:right;">
0.0001094486
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0001094486
</td>
<td style="text-align:right;">
348
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
-0.15670733
</td>
<td style="text-align:right;">
0.01015333
</td>
<td style="text-align:right;">
-15.434083
</td>
<td style="text-align:right;">
77.06546
</td>
<td style="text-align:right;">
0.000e+00
</td>
<td style="text-align:right;">
-0.17692492
</td>
<td style="text-align:right;">
-0.13648974
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.024979560
</td>
<td style="text-align:right;">
0.0001030901
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0001030901
</td>
<td style="text-align:right;">
79
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.30489203
</td>
<td style="text-align:right;">
0.01614869
</td>
<td style="text-align:right;">
18.880298
</td>
<td style="text-align:right;">
172.01669
</td>
<td style="text-align:right;">
0.000e+00
</td>
<td style="text-align:right;">
0.27301693
</td>
<td style="text-align:right;">
0.33676713
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.011427482
</td>
<td style="text-align:right;">
0.0002607801
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0002607801
</td>
<td style="text-align:right;">
174
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_a
</td>
<td style="text-align:right;">
0.06143607
</td>
<td style="text-align:right;">
0.01195309
</td>
<td style="text-align:right;">
5.139763
</td>
<td style="text-align:right;">
299.98965
</td>
<td style="text-align:right;">
4.968e-07
</td>
<td style="text-align:right;">
0.03791354
</td>
<td style="text-align:right;">
0.08495860
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.006600885
</td>
<td style="text-align:right;">
0.0001428764
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.0001428764
</td>
<td style="text-align:right;">
302
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. mi estimate: mean g_a [aw = pondera],over(mobility_actual)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =        907
                                  Average RVI     =     0.0000
                                  Largest FMI     =     0.0000
                                  Complete DF     =        906
DF adjustment:   Small sample     DF:     min     =     904.01
                                          avg     =     904.01
Within VCE type:     Analytic             max     =     904.01

            1: mobility_actual = 1
            2: mobility_actual = 2
            3: mobility_actual = 3
            4: mobility_actual = 4

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
           1 |   .0779852   .0104618       .057453    .0985174
           2 |  -.1567073   .0101533     -.1766342   -.1367805
           3 |    .304892   .0161487      .2731988    .3365853
           4 |   .0614361   .0119531       .037977    .0848951
--------------------------------------------------------------</code></pre>
</div>
<div id="mi-estimate-mean-g_p-aw-ponderaovermobility_pred-2" class="section level4">
<h4 class="hasAnchor">
<a href="#mi-estimate-mean-g_p-aw-ponderaovermobility_pred-2" class="anchor"></a><code>mi estimate: mean g_p [aw = pondera],over(mobility_pred)</code>
</h4>
<p>R:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">bind_rows</span>(</a>
<a class="sourceLine" id="cb59-2" title="2">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(nicaragua_mi_data, <span class="st">"g_p"</span>, <span class="st">"mobility_pred"</span>, <span class="st">"pondera"</span>, <span class="dt">use_random =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb59-3" title="3">  <span class="kw"><a href="../reference/get_mi_mean_by_group.html">get_mi_mean_by_group</a></span>(nicaragua_mi_data, <span class="st">"g_p"</span>, <span class="st">"mobility_pred"</span>, <span class="st">"pondera"</span>, <span class="dt">use_random =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb59-4" title="4">  ) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb59-5" title="5"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
mobility_pred
</th>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
ubar
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
t
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.07422098
</td>
<td style="text-align:right;">
0.01712409
</td>
<td style="text-align:right;">
4.334302
</td>
<td style="text-align:right;">
64.04024
</td>
<td style="text-align:right;">
0.0000527101
</td>
<td style="text-align:right;">
0.04001209
</td>
<td style="text-align:right;">
0.10842987
</td>
<td style="text-align:right;">
1.456459
</td>
<td style="text-align:right;">
0.5929099
</td>
<td style="text-align:right;">
0.6050546
</td>
<td style="text-align:right;">
0.0001193729
</td>
<td style="text-align:right;">
0.0001704526
</td>
<td style="text-align:right;">
0.0002932345
</td>
<td style="text-align:right;">
293
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.22202289
</td>
<td style="text-align:right;">
0.01524915
</td>
<td style="text-align:right;">
-14.559688
</td>
<td style="text-align:right;">
36.51596
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
-0.25293444
</td>
<td style="text-align:right;">
-0.19111134
</td>
<td style="text-align:right;">
1.240723
</td>
<td style="text-align:right;">
0.5537155
</td>
<td style="text-align:right;">
0.5763030
</td>
<td style="text-align:right;">
0.0001037775
</td>
<td style="text-align:right;">
0.0001262344
</td>
<td style="text-align:right;">
0.0002325366
</td>
<td style="text-align:right;">
108
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.38289479
</td>
<td style="text-align:right;">
0.03230056
</td>
<td style="text-align:right;">
11.854121
</td>
<td style="text-align:right;">
38.10167
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.31751145
</td>
<td style="text-align:right;">
0.44827813
</td>
<td style="text-align:right;">
1.774685
</td>
<td style="text-align:right;">
0.6395987
</td>
<td style="text-align:right;">
0.6571358
</td>
<td style="text-align:right;">
0.0003760162
</td>
<td style="text-align:right;">
0.0006542257
</td>
<td style="text-align:right;">
0.0010433263
</td>
<td style="text-align:right;">
157
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.03170421
</td>
<td style="text-align:right;">
0.02204939
</td>
<td style="text-align:right;">
1.437872
</td>
<td style="text-align:right;">
46.99602
</td>
<td style="text-align:right;">
0.1570962506
</td>
<td style="text-align:right;">
-0.01265355
</td>
<td style="text-align:right;">
0.07606197
</td>
<td style="text-align:right;">
1.815064
</td>
<td style="text-align:right;">
0.6447683
</td>
<td style="text-align:right;">
0.6589787
</td>
<td style="text-align:right;">
0.0001727051
</td>
<td style="text-align:right;">
0.0003073242
</td>
<td style="text-align:right;">
0.0004861758
</td>
<td style="text-align:right;">
222
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.07463307
</td>
<td style="text-align:right;">
0.01655531
</td>
<td style="text-align:right;">
4.508104
</td>
<td style="text-align:right;">
66.65774
</td>
<td style="text-align:right;">
0.0000271294
</td>
<td style="text-align:right;">
0.04158541
</td>
<td style="text-align:right;">
0.10768073
</td>
<td style="text-align:right;">
1.375086
</td>
<td style="text-align:right;">
0.5789626
</td>
<td style="text-align:right;">
0.5910514
</td>
<td style="text-align:right;">
0.0001153972
</td>
<td style="text-align:right;">
0.0001555697
</td>
<td style="text-align:right;">
0.0002740784
</td>
<td style="text-align:right;">
293
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
-0.22602198
</td>
<td style="text-align:right;">
0.01664458
</td>
<td style="text-align:right;">
-13.579316
</td>
<td style="text-align:right;">
31.31733
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
-0.25995488
</td>
<td style="text-align:right;">
-0.19208907
</td>
<td style="text-align:right;">
1.576220
</td>
<td style="text-align:right;">
0.6118344
</td>
<td style="text-align:right;">
0.6344566
</td>
<td style="text-align:right;">
0.0001075381
</td>
<td style="text-align:right;">
0.0001661802
</td>
<td style="text-align:right;">
0.0002770420
</td>
<td style="text-align:right;">
108
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.38644460
</td>
<td style="text-align:right;">
0.03266324
</td>
<td style="text-align:right;">
11.831178
</td>
<td style="text-align:right;">
40.17323
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.32043859
</td>
<td style="text-align:right;">
0.45245060
</td>
<td style="text-align:right;">
1.638856
</td>
<td style="text-align:right;">
0.6210479
</td>
<td style="text-align:right;">
0.6386029
</td>
<td style="text-align:right;">
0.0004042991
</td>
<td style="text-align:right;">
0.0006495962
</td>
<td style="text-align:right;">
0.0010668872
</td>
<td style="text-align:right;">
157
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
g_p
</td>
<td style="text-align:right;">
0.03449319
</td>
<td style="text-align:right;">
0.02242891
</td>
<td style="text-align:right;">
1.537890
</td>
<td style="text-align:right;">
45.54402
</td>
<td style="text-align:right;">
0.1309947944
</td>
<td style="text-align:right;">
-0.01066606
</td>
<td style="text-align:right;">
0.07965243
</td>
<td style="text-align:right;">
1.902115
</td>
<td style="text-align:right;">
0.6554238
</td>
<td style="text-align:right;">
0.6696202
</td>
<td style="text-align:right;">
0.0001733411
</td>
<td style="text-align:right;">
0.0003232497
</td>
<td style="text-align:right;">
0.0005030558
</td>
<td style="text-align:right;">
222
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code> mi estimate: mean g_p [aw = pondera],over(mobility_pred)

Multiple-imputation estimates     Imputations     =         50
Mean estimation                   Number of obs   =        907
                                  Average RVI     =     1.6899
                                  Largest FMI     =     0.7249
                                  Complete DF     =        906
DF adjustment:   Small sample     DF:     min     =      69.31
                                          avg     =      97.70
Within VCE type:     Analytic             max     =     131.68

            1: mobility_pred = 1
            2: mobility_pred = 2
            3: mobility_pred = 3
            4: mobility_pred = 4

--------------------------------------------------------------
        Over |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
           1 |   .0784313   .0150065      .0487463    .1081162
           2 |  -.2164065   .0174165     -.2511488   -.1816642
           3 |   .3853249   .0275537      .3306229    .4400269
           4 |   .0411381   .0206718       .000099    .0821771
--------------------------------------------------------------
Note: Numbers of observations in e(_N) vary among imputations.</code></pre>
</div>
<div id="poverty-analysis-2" class="section level3">
<h3 class="hasAnchor">
<a href="#poverty-analysis-2" class="anchor"></a>Poverty analysis</h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">pl_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="fl">5.5</span> <span class="op">*</span><span class="st"> </span><span class="fl">30.41667</span></a>
<a class="sourceLine" id="cb61-2" title="2">pl_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="dv">13</span> <span class="op">*</span><span class="st"> </span><span class="fl">30.41667</span></a>
<a class="sourceLine" id="cb61-3" title="3"></a>
<a class="sourceLine" id="cb61-4" title="4">nicaragua_poverty_calc &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb61-5" title="5"><span class="st">  </span>nicaragua_mi_data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">ipcf =</span> <span class="kw">if_else</span>(.imp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA_real_</span>, ipcf),</a>
<a class="sourceLine" id="cb61-7" title="7">         <span class="op">!!</span><span class="dt">pred_var_period0_enquo :=</span> <span class="kw">if_else</span>(.imp <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="ot">NA_real_</span>, <span class="op">!!</span>pred_var_period0_enquo)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf, <span class="st">"act"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(ipcf_pred, <span class="st">"pred"</span>, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-10" title="10"><span class="st">  </span><span class="kw"><a href="../reference/detect_poverty.html">detect_poverty</a></span>(<span class="op">!!</span>pred_var_period0_enquo, period0_year, pl_<span class="dv">1</span>, pl_<span class="dv">2</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb61-11" title="11"><span class="st">  </span><span class="kw">select</span>(.id, .imp, pondera, <span class="kw">contains</span>(<span class="st">"ipcf"</span>), </a>
<a class="sourceLine" id="cb61-12" title="12">         <span class="kw">contains</span>(<span class="st">"_act"</span>), <span class="op">-</span><span class="kw">contains</span>(<span class="st">"_actual"</span>), </a>
<a class="sourceLine" id="cb61-13" title="13">         <span class="kw">contains</span>(<span class="st">"_pred"</span>), <span class="kw">contains</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"_"</span>, period0_year))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-14" title="14"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb61-15" title="15">    (.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-16" title="16"><span class="st">      </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_"</span>, period0_year,<span class="st">"$"</span>)), <span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_act$"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-17" title="17"><span class="st">      </span><span class="kw"><a href="../reference/get_all_combinations.html">get_all_combinations</a></span>(mAct)</a>
<a class="sourceLine" id="cb61-18" title="18">  )  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-19" title="19"><span class="st">  </span><span class="kw">left_join</span>(</a>
<a class="sourceLine" id="cb61-20" title="20">    (.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-21" title="21"><span class="st">      </span><span class="kw">select</span>(<span class="kw">matches</span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste0</a></span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_"</span>, period0_year,<span class="st">"$"</span>)), <span class="kw">matches</span>(<span class="st">"</span><span class="ch">\\</span><span class="st">d.{1,}_pred$"</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb61-22" title="22"><span class="st">      </span><span class="kw"><a href="../reference/get_all_combinations.html">get_all_combinations</a></span>(mPred)</a>
<a class="sourceLine" id="cb61-23" title="23">  )</a></code></pre></div>
<div id="actual-mobility-2" class="section level4">
<h4 class="hasAnchor">
<a href="#actual-mobility-2" class="anchor"></a>Actual mobility</h4>
<p>R:</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">compare_vars &lt;-</a>
<a class="sourceLine" id="cb62-2" title="2"><span class="st">  </span>nicaragua_poverty_calc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magrittr/topics/aliases">extract</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">"mAct_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>()</a>
<a class="sourceLine" id="cb62-6" title="6">nic_act_mob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb62-7" title="7"><span class="st">  </span>nicaragua_poverty_calc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-8" title="8"><span class="st">  </span><span class="kw"><a href="../reference/get_mi_means_table.html">get_mi_means_table</a></span>(compare_vars, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-9" title="9"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ubar, <span class="op">-</span>t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-10" title="10"><span class="st">  </span><span class="kw">arrange</span>(variable) </a>
<a class="sourceLine" id="cb62-11" title="11">nic_act_mob <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb62-12" title="12"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mAct_1poor_1poor
</td>
<td style="text-align:right;">
0.41007302
</td>
<td style="text-align:right;">
0.016340511
</td>
<td style="text-align:right;">
25.095484
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.378003268
</td>
<td style="text-align:right;">
0.44214278
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_1poor_2vul
</td>
<td style="text-align:right;">
0.08205597
</td>
<td style="text-align:right;">
0.009117990
</td>
<td style="text-align:right;">
8.999349
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.064161079
</td>
<td style="text-align:right;">
0.09995086
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_1poor_3mid
</td>
<td style="text-align:right;">
0.01044439
</td>
<td style="text-align:right;">
0.003377517
</td>
<td style="text-align:right;">
3.092328
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0020468827
</td>
<td style="text-align:right;">
0.003815704
</td>
<td style="text-align:right;">
0.01707308
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_1poor
</td>
<td style="text-align:right;">
0.18088658
</td>
<td style="text-align:right;">
0.012788249
</td>
<td style="text-align:right;">
14.144749
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.155788462
</td>
<td style="text-align:right;">
0.20598469
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_2vul
</td>
<td style="text-align:right;">
0.12945541
</td>
<td style="text-align:right;">
0.011152995
</td>
<td style="text-align:right;">
11.607233
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.107566632
</td>
<td style="text-align:right;">
0.15134419
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_2vul_3mid
</td>
<td style="text-align:right;">
0.04105287
</td>
<td style="text-align:right;">
0.006591815
</td>
<td style="text-align:right;">
6.227855
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0000000007
</td>
<td style="text-align:right;">
0.028115826
</td>
<td style="text-align:right;">
0.05398991
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_1poor
</td>
<td style="text-align:right;">
0.02610165
</td>
<td style="text-align:right;">
0.005296960
</td>
<td style="text-align:right;">
4.927666
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0000009896
</td>
<td style="text-align:right;">
0.015705879
</td>
<td style="text-align:right;">
0.03649742
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_2vul
</td>
<td style="text-align:right;">
0.06642982
</td>
<td style="text-align:right;">
0.008273531
</td>
<td style="text-align:right;">
8.029198
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.050192252
</td>
<td style="text-align:right;">
0.08266738
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mAct_3mid_3mid
</td>
<td style="text-align:right;">
0.05350029
</td>
<td style="text-align:right;">
0.007476085
</td>
<td style="text-align:right;">
7.156191
</td>
<td style="text-align:right;">
903.916
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.038827791
</td>
<td style="text-align:right;">
0.06817280
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0.002205276
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
906
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata (additional statistics is ommited):</p>
<pre><code>. local status "pp pv pm vp vv vm mp mv mm"

. 
. foreach x of local status {
  2.     local s = "`x'"
  3.         display "`s'"
  4.         mi estimate: mean `s'_actual [aw = pondera]
  5. }
--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
   pp_actual |    .410073   .0163405      .3780033    .4421428
   pv_actual |    .082056    .009118      .0641611    .0999509
   pm_actual |   .0104444   .0033775      .0038157    .0170731
   vp_actual |   .1808866   .0127882      .1557885    .2059847
   vv_actual |   .1294554    .011153      .1075666    .1513442
   vm_actual |   .0410529   .0065918      .0281158    .0539899
   mp_actual |   .0261016    .005297      .0157059    .0364974
   mv_actual |   .0664298   .0082735      .0501923    .0826674
   mm_actual |   .0535003   .0074761      .0388278    .0681728
--------------------------------------------------------------</code></pre>
</div>
<div id="predicted-mobility-2" class="section level4">
<h4 class="hasAnchor">
<a href="#predicted-mobility-2" class="anchor"></a>Predicted mobility</h4>
<p>R:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1">compare_vars2 &lt;-</a>
<a class="sourceLine" id="cb64-2" title="2"><span class="st">  </span>nicaragua_poverty_calc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-3" title="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb64-4" title="4"><span class="st">  </span>magrittr<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/magrittr/topics/aliases">extract</a></span>(stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span>(., <span class="st">"mPred_"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-5" title="5"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sort">sort</a></span>()</a>
<a class="sourceLine" id="cb64-6" title="6"></a>
<a class="sourceLine" id="cb64-7" title="7">nic_pred_mob &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb64-8" title="8"><span class="st">  </span>nicaragua_poverty_calc <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-9" title="9"><span class="st">  </span><span class="kw"><a href="../reference/get_mi_means_table.html">get_mi_means_table</a></span>(compare_vars2, <span class="st">"pondera"</span>) <span class="op">%&gt;%</span><span class="st">  </span></a>
<a class="sourceLine" id="cb64-10" title="10"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>ubar, <span class="op">-</span>t) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-11" title="11"><span class="st">  </span><span class="kw">arrange</span>(variable) </a>
<a class="sourceLine" id="cb64-12" title="12">nic_pred_mob <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb64-13" title="13"><span class="st">  </span><span class="kw">format_kable</span>()</a></code></pre></div>
<div style="border: 1px solid #ddd; padding: 0px; overflow-y: scroll; height:300px; overflow-x: scroll; width:100%; ">
<table class="table table table-striped table-condensed table-bordered">
<thead><tr>
<th style="text-align:left;position: sticky; top:0; background-color: #FFFFFF;">
variable
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
estimate
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
std.error
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
statistic
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
df
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
p.value
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
2.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
97.5 %
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
riv
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
lambda
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
fmi
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
b
</th>
<th style="text-align:right;position: sticky; top:0; background-color: #FFFFFF;">
dfcom
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
mPred_1poor_1poor
</td>
<td style="text-align:right;">
0.31981337
</td>
<td style="text-align:right;">
0.024213470
</td>
<td style="text-align:right;">
13.208077
</td>
<td style="text-align:right;">
101.66871
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.27178418
</td>
<td style="text-align:right;">
0.36784255
</td>
<td style="text-align:right;">
1.4455853
</td>
<td style="text-align:right;">
0.5910999
</td>
<td style="text-align:right;">
0.5989132
</td>
<td style="text-align:right;">
0.0003397620
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_1poor_2vul
</td>
<td style="text-align:right;">
0.14266030
</td>
<td style="text-align:right;">
0.019805464
</td>
<td style="text-align:right;">
7.203078
</td>
<td style="text-align:right;">
83.21209
</td>
<td style="text-align:right;">
0.0000000002
</td>
<td style="text-align:right;">
0.10326952
</td>
<td style="text-align:right;">
0.18205109
</td>
<td style="text-align:right;">
1.9115325
</td>
<td style="text-align:right;">
0.6565383
</td>
<td style="text-align:right;">
0.6645061
</td>
<td style="text-align:right;">
0.0002524817
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_1poor_3mid
</td>
<td style="text-align:right;">
0.04009972
</td>
<td style="text-align:right;">
0.012554765
</td>
<td style="text-align:right;">
3.193984
</td>
<td style="text-align:right;">
66.54154
</td>
<td style="text-align:right;">
0.0021450689
</td>
<td style="text-align:right;">
0.01503713
</td>
<td style="text-align:right;">
0.06516231
</td>
<td style="text-align:right;">
2.7207390
</td>
<td style="text-align:right;">
0.7312362
</td>
<td style="text-align:right;">
0.7389658
</td>
<td style="text-align:right;">
0.0001129990
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_1poor
</td>
<td style="text-align:right;">
0.15894551
</td>
<td style="text-align:right;">
0.017999058
</td>
<td style="text-align:right;">
8.830768
</td>
<td style="text-align:right;">
117.69782
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.12330153
</td>
<td style="text-align:right;">
0.19458950
</td>
<td style="text-align:right;">
1.1984011
</td>
<td style="text-align:right;">
0.5451240
</td>
<td style="text-align:right;">
0.5526614
</td>
<td style="text-align:right;">
0.0001731389
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_2vul
</td>
<td style="text-align:right;">
0.13738399
</td>
<td style="text-align:right;">
0.017093014
</td>
<td style="text-align:right;">
8.037435
</td>
<td style="text-align:right;">
114.77808
</td>
<td style="text-align:right;">
0.0000000000
</td>
<td style="text-align:right;">
0.10352532
</td>
<td style="text-align:right;">
0.17124265
</td>
<td style="text-align:right;">
1.2365622
</td>
<td style="text-align:right;">
0.5528852
</td>
<td style="text-align:right;">
0.5604777
</td>
<td style="text-align:right;">
0.0001583697
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_2vul_3mid
</td>
<td style="text-align:right;">
0.05506535
</td>
<td style="text-align:right;">
0.012457962
</td>
<td style="text-align:right;">
4.420093
</td>
<td style="text-align:right;">
90.00342
</td>
<td style="text-align:right;">
0.0000274798
</td>
<td style="text-align:right;">
0.03031545
</td>
<td style="text-align:right;">
0.07981525
</td>
<td style="text-align:right;">
1.7072450
</td>
<td style="text-align:right;">
0.6306208
</td>
<td style="text-align:right;">
0.6385641
</td>
<td style="text-align:right;">
0.0000959538
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_1poor
</td>
<td style="text-align:right;">
0.04039764
</td>
<td style="text-align:right;">
0.010442596
</td>
<td style="text-align:right;">
3.868544
</td>
<td style="text-align:right;">
96.38839
</td>
<td style="text-align:right;">
0.0001989997
</td>
<td style="text-align:right;">
0.01967031
</td>
<td style="text-align:right;">
0.06112496
</td>
<td style="text-align:right;">
1.5527743
</td>
<td style="text-align:right;">
0.6082693
</td>
<td style="text-align:right;">
0.6161521
</td>
<td style="text-align:right;">
0.0000650298
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_2vul
</td>
<td style="text-align:right;">
0.06097912
</td>
<td style="text-align:right;">
0.011766750
</td>
<td style="text-align:right;">
5.182325
</td>
<td style="text-align:right;">
118.08857
</td>
<td style="text-align:right;">
0.0000009155
</td>
<td style="text-align:right;">
0.03767793
</td>
<td style="text-align:right;">
0.08428031
</td>
<td style="text-align:right;">
1.1934825
</td>
<td style="text-align:right;">
0.5441040
</td>
<td style="text-align:right;">
0.5516339
</td>
<td style="text-align:right;">
0.0000738575
</td>
<td style="text-align:right;">
906
</td>
</tr>
<tr>
<td style="text-align:left;">
mPred_3mid_3mid
</td>
<td style="text-align:right;">
0.04465500
</td>
<td style="text-align:right;">
0.009566396
</td>
<td style="text-align:right;">
4.667902
</td>
<td style="text-align:right;">
143.42597
</td>
<td style="text-align:right;">
0.0000069207
</td>
<td style="text-align:right;">
0.02574566
</td>
<td style="text-align:right;">
0.06356434
</td>
<td style="text-align:right;">
0.9454934
</td>
<td style="text-align:right;">
0.4859916
</td>
<td style="text-align:right;">
0.4930123
</td>
<td style="text-align:right;">
0.0000436039
</td>
<td style="text-align:right;">
906
</td>
</tr>
</tbody>
</table>
</div>
<p>Stata:</p>
<pre><code>. local status "pp pv pm vp vv vm mp mv mm"

. foreach x of local status {
  2.     local s = "`x'"
  3.         display "`s'"
  4.         mi estimate: mean `s'_pred [aw = pondera]
  5. }
--------------------------------------------------------------
             |       Mean   Std. Err.     [95% Conf. Interval]
-------------+------------------------------------------------
     pp_pred |   .3754969    .027902      .3199736    .4310202
     pv_pred |   .1120075   .0142728      .0838148    .1402002
     pm_pred |   .0272405   .0083761      .0106306    .0438505
     vp_pred |   .1882514    .025493      .1373318    .2391709
     vv_pred |   .1104124   .0142902       .082179    .1386457
     vm_pred |   .0432484   .0098154      .0238226    .0626742
     mp_pred |   .0533129   .0144214      .0245213    .0821046
     mv_pred |   .0555213   .0107385      .0342873    .0767554
     mm_pred |   .0345086   .0087538      .0171871    .0518301
--------------------------------------------------------------</code></pre>
</div>
</div>
</div>
<div id="mobility-summary" class="section level2">
<h2 class="hasAnchor">
<a href="#mobility-summary" class="anchor"></a>Mobility summary</h2>
<pre><code>#&gt; Joining, by = "variable"
#&gt; Joining, by = "variable"
#&gt; Joining, by = "variable"
#&gt; Joining, by = "variable"</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)</a>
<a class="sourceLine" id="cb67-2" title="2"></a>
<a class="sourceLine" id="cb67-3" title="3">plot_data &lt;-</a>
<a class="sourceLine" id="cb67-4" title="4"><span class="st">  </span><span class="kw">tibble</span>(</a>
<a class="sourceLine" id="cb67-5" title="5">    <span class="dt">country =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Chile"</span>, <span class="st">"Peru"</span>, <span class="st">"Argentina"</span>, <span class="st">"Nicaragua"</span>), <span class="dt">each =</span> <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb67-6" title="6">    <span class="dt">type =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"Actual"</span>, <span class="st">"Pred-Stata"</span>, <span class="st">"Pred-R"</span>), <span class="dv">4</span>),</a>
<a class="sourceLine" id="cb67-7" title="7">    <span class="dt">data =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(</a>
<a class="sourceLine" id="cb67-8" title="8">      chil_act_mob,</a>
<a class="sourceLine" id="cb67-9" title="9">      chil_pred_stata,</a>
<a class="sourceLine" id="cb67-10" title="10">      chil_pred_mob,</a>
<a class="sourceLine" id="cb67-11" title="11">      </a>
<a class="sourceLine" id="cb67-12" title="12">      peru_act_mob,</a>
<a class="sourceLine" id="cb67-13" title="13">      per_pred_stata,</a>
<a class="sourceLine" id="cb67-14" title="14">      peru_pred_mob,</a>
<a class="sourceLine" id="cb67-15" title="15">      </a>
<a class="sourceLine" id="cb67-16" title="16">      arg_act_mob,</a>
<a class="sourceLine" id="cb67-17" title="17">      arg_pred_stata,</a>
<a class="sourceLine" id="cb67-18" title="18">      arg_pred_mob,</a>
<a class="sourceLine" id="cb67-19" title="19">      </a>
<a class="sourceLine" id="cb67-20" title="20">      nic_act_mob,</a>
<a class="sourceLine" id="cb67-21" title="21">      nic_pred_stata,</a>
<a class="sourceLine" id="cb67-22" title="22">      nic_pred_mob</a>
<a class="sourceLine" id="cb67-23" title="23">    )</a>
<a class="sourceLine" id="cb67-24" title="24">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-25" title="25"><span class="st">  </span><span class="kw">unnest</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-26" title="26"><span class="st">  </span><span class="kw">separate</span>(variable, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"type2"</span>, <span class="st">"from"</span>, <span class="st">"to"</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-27" title="27"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(from, to), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="op">~</span>stringr<span class="op">::</span><span class="kw"><a href="https://stringr.tidyverse.org/reference/str_sub.html">str_sub</a></span>(., <span class="dv">1</span>, <span class="dv">2</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-28" title="28"><span class="st">  </span><span class="kw">unite</span>(mobility, from, to, <span class="dt">sep =</span> <span class="st">"-&gt;"</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-29" title="29"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="kw">vars</span>(estimate, <span class="st">`</span><span class="dt">2.5 %</span><span class="st">`</span>, <span class="st">`</span><span class="dt">97.5 %</span><span class="st">`</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list">list</a></span>(<span class="op">~</span>.<span class="op">*</span><span class="dv">100</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-30" title="30"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">line_start =</span> <span class="st">`</span><span class="dt">2.5 %</span><span class="st">`</span>, <span class="dt">line_end =</span> <span class="st">`</span><span class="dt">97.5 %</span><span class="st">`</span>)<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-31" title="31"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">count =</span> country)</a>
<a class="sourceLine" id="cb67-32" title="32"></a>
<a class="sourceLine" id="cb67-33" title="33">plot_country &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb67-34" title="34"><span class="st">  </span><span class="cf">function</span>(.data, COUNTRY) {</a>
<a class="sourceLine" id="cb67-35" title="35">    p &lt;-<span class="st"> </span></a>
<a class="sourceLine" id="cb67-36" title="36"><span class="st">      </span>.data <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb67-37" title="37"><span class="st">      </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(country <span class="op">==</span><span class="st"> </span>COUNTRY) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb67-38" title="38"><span class="st">      </span><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb67-39" title="39"><span class="st">      </span><span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb67-40" title="40">        <span class="dt">x =</span> type,</a>
<a class="sourceLine" id="cb67-41" title="41">        <span class="dt">y =</span> estimate,</a>
<a class="sourceLine" id="cb67-42" title="42">        <span class="dt">group =</span> mobility,</a>
<a class="sourceLine" id="cb67-43" title="43">        <span class="dt">colour =</span> type,</a>
<a class="sourceLine" id="cb67-44" title="44">        <span class="dt">fill =</span> type</a>
<a class="sourceLine" id="cb67-45" title="45">      ) <span class="op">+</span></a>
<a class="sourceLine" id="cb67-46" title="46"><span class="st">      </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb67-47" title="47"><span class="st">      </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> line_start, <span class="dt">ymax =</span> line_end), <span class="dt">width =</span></a>
<a class="sourceLine" id="cb67-48" title="48">                      <span class="fl">.1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb67-49" title="49"><span class="st">      </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>mobility, <span class="dt">scales =</span> <span class="st">"free"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb67-50" title="50"><span class="st">      </span><span class="kw">labs</span>(<span class="dt">title =</span> COUNTRY) <span class="op">+</span></a>
<a class="sourceLine" id="cb67-51" title="51"><span class="st">      </span><span class="kw">xlab</span>(<span class="st">"Estimation method"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb67-52" title="52"><span class="st">      </span><span class="kw">ylab</span>(<span class="st">"%"</span>) </a>
<a class="sourceLine" id="cb67-53" title="53">    <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/print">print</a></span>(p)</a>
<a class="sourceLine" id="cb67-54" title="54">  }</a></code></pre></div>
<p>Argentina</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">plot_country</span>(plot_data, <span class="st">"Argentina"</span>)</a></code></pre></div>
<p><img src="r_vs_stata_lassopmm_files/figure-html/unnamed-chunk-54-1.png" width="700"></p>
<p>Chile</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1"><span class="kw">plot_country</span>(plot_data, <span class="st">"Chile"</span>)</a></code></pre></div>
<p><img src="r_vs_stata_lassopmm_files/figure-html/unnamed-chunk-55-1.png" width="700"></p>
<p>Nicaragua</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">plot_country</span>(plot_data, <span class="st">"Nicaragua"</span>)</a></code></pre></div>
<p><img src="r_vs_stata_lassopmm_files/figure-html/unnamed-chunk-56-1.png" width="700"></p>
<p>Peru</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">plot_country</span>(plot_data, <span class="st">"Peru"</span>)</a></code></pre></div>
<p><img src="r_vs_stata_lassopmm_files/figure-html/unnamed-chunk-57-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#argentina-example">Argentina example</a></li>
      <li><a href="#chile-example">Chile example</a></li>
      <li><a href="#peru-example">Peru example</a></li>
      <li><a href="#nicaragua-example">Nicaragua example</a></li>
      <li><a href="#mobility-summary">Mobility summary</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Leonardo Lucchetti, Paul Corral, Eduard Bukin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
